{"file_contents":{"app.py":{"content":"import os\nimport logging\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nfrom sqlalchemy.orm import DeclarativeBase\nfrom sqlalchemy.exc import OperationalError\nfrom sqlalchemy import text\nfrom werkzeug.middleware.proxy_fix import ProxyFix\n\n# Configure logging\nlogging.basicConfig(level=logging.DEBUG)\nlogger = logging.getLogger(__name__)\n\nclass Base(DeclarativeBase):\n    pass\n\ndb = SQLAlchemy(model_class=Base)\n\n# Create the app\napp = Flask(__name__)\napp.secret_key = os.environ.get(\"SESSION_SECRET\", \"dev-secret-key\")\napp.wsgi_app = ProxyFix(app.wsgi_app, x_proto=1, x_host=1)\n\n# Configure the database with error handling\ndatabase_url = os.environ.get(\"DATABASE_URL\")\nif database_url:\n    logger.info(f\"Using PostgreSQL database: {database_url[:50]}...\")\n    app.config[\"SQLALCHEMY_DATABASE_URI\"] = database_url\n    app.config[\"SQLALCHEMY_ENGINE_OPTIONS\"] = {\n        \"pool_recycle\": 300,\n        \"pool_pre_ping\": True,\n        \"pool_timeout\": 20,\n        \"max_overflow\": 0,\n        \"connect_args\": {\n            \"connect_timeout\": 10,\n            \"application_name\": \"ric_app\"\n        }\n    }\nelse:\n    logger.warning(\"No DATABASE_URL found, falling back to SQLite\")\n    app.config[\"SQLALCHEMY_DATABASE_URI\"] = \"sqlite:///ric.db\"\n    app.config[\"SQLALCHEMY_ENGINE_OPTIONS\"] = {\n        \"pool_recycle\": 300,\n        \"pool_pre_ping\": True,\n    }\n\n# Configure upload settings\napp.config['UPLOAD_FOLDER'] = 'uploads'\napp.config['MAX_CONTENT_LENGTH'] = 100 * 1024 * 1024  # 100MB max file size\n\n# Initialize extensions\ndb.init_app(app)\n\n# Ensure upload directory exists\ntry:\n    os.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)\n    logger.info(f\"Upload directory created: {app.config['UPLOAD_FOLDER']}\")\nexcept Exception as e:\n    logger.error(f\"Failed to create upload directory: {str(e)}\")\n\n# Add health check function\n@app.route('/health')\ndef health_check():\n    \"\"\"Health check endpoint for deployment monitoring\"\"\"\n    status = {\n        'status': 'healthy',\n        'database': 'connected' if db_initialized else 'disconnected',\n        'upload_dir': os.path.exists(app.config['UPLOAD_FOLDER'])\n    }\n    return status, 200 if 'db_initialized' in globals() and db_initialized else 503\n\ndef initialize_database():\n    \"\"\"Initialize database with proper error handling\"\"\"\n    try:\n        with app.app_context():\n            # Test database connection\n            with db.engine.connect() as conn:\n                conn.execute(text('SELECT 1'))\n            logger.info(\"Database connection successful\")\n            \n            # Import models and routes\n            import models  # noqa: F401\n            import routes  # noqa: F401\n            \n            # Create all database tables\n            db.create_all()\n            logger.info(\"Database tables created successfully\")\n            return True\n            \n    except OperationalError as e:\n        logger.error(f\"Database connection failed: {str(e)}\")\n        logger.error(\"Application will continue with limited functionality\")\n        return False\n    except Exception as e:\n        logger.error(f\"Unexpected database error: {str(e)}\")\n        return False\n\n# Initialize database\ndb_initialized = initialize_database()\n\n# Import routes even if database fails (for health checks, etc.)\nif not db_initialized:\n    try:\n        import routes  # noqa: F401\n        logger.info(\"Routes imported despite database connection failure\")\n    except Exception as e:\n        logger.error(f\"Failed to import routes: {str(e)}\")\n","size_bytes":3505},"audio_processor.py":{"content":"import os\nimport re\nimport logging\nfrom openai import OpenAI\n\nclass AudioProcessor:\n    \"\"\"Audio processing for transcription and basic analysis\"\"\"\n    \n    def __init__(self):\n        self.openai_client = OpenAI(api_key=os.environ.get(\"OPENAI_API_KEY\"))\n        \n        # Spanish filler words for educational context\n        self.spanish_fillers = [\n            'eh', 'este', 'esto', 'um', 'uh', 'mm', 'hmm', 'bueno', 'o sea',\n            'entonces', 'pues', 'como', 'verdad', 'no', 'si', 'claro',\n            'emmm', 'eeeh', 'aaa', 'eee'\n        ]\n    \n    def transcribe_audio(self, audio_file_path):\n        \"\"\"\n        Transcribe audio using Whisper API with educational focus\n        \n        Args:\n            audio_file_path: Path to audio file\n            \n        Returns:\n            Dict with transcription results including educational metrics\n        \"\"\"\n        try:\n            logging.info(f\"Starting transcription of {audio_file_path}\")\n            \n            # Transcribe with Whisper\n            with open(audio_file_path, 'rb') as audio_file:\n                response = self.openai_client.audio.transcriptions.create(\n                    model=\"whisper-1\",\n                    file=audio_file,\n                    language=\"es\",  # Spanish optimization\n                    response_format=\"verbose_json\"\n                )\n            \n            text = response.text\n            segments = getattr(response, 'segments', [])\n            \n            # Convert segments to serializable format\n            serializable_segments = []\n            for segment in segments:\n                serializable_segments.append({\n                    'id': getattr(segment, 'id', 0),\n                    'start': getattr(segment, 'start', 0.0),\n                    'end': getattr(segment, 'end', 0.0),\n                    'text': getattr(segment, 'text', ''),\n                    'tokens': getattr(segment, 'tokens', []),\n                    'temperature': getattr(segment, 'temperature', 0.0),\n                    'avg_logprob': getattr(segment, 'avg_logprob', 0.0),\n                    'compression_ratio': getattr(segment, 'compression_ratio', 0.0),\n                    'no_speech_prob': getattr(segment, 'no_speech_prob', 0.0)\n                })\n            \n            # Calculate educational metrics\n            metrics = self._calculate_speech_metrics(text, segments)\n            \n            return {\n                'text': text,\n                'segments': serializable_segments,\n                'duration': getattr(response, 'duration', 0),\n                **metrics\n            }\n            \n        except Exception as e:\n            logging.error(f\"Transcription error: {str(e)}\")\n            raise e\n    \n    def analyze_prosody(self, audio_file_path):\n        \"\"\"\n        Basic prosodic analysis (fallback when advanced tools unavailable)\n        \n        Args:\n            audio_file_path: Path to audio file\n            \n        Returns:\n            Dict with basic prosodic analysis results\n        \"\"\"\n        try:\n            logging.info(f\"Starting basic prosodic analysis of {audio_file_path}\")\n            \n            # Try to get file duration for basic analysis\n            try:\n                import os\n                file_size = os.path.getsize(audio_file_path)\n                # Rough estimation: assume 1MB = ~1 minute for typical audio\n                estimated_duration = file_size / (1024 * 1024)  # rough estimate\n            except:\n                estimated_duration = 60.0  # default estimate\n            \n            # Return typical values for educational speech analysis\n            return {\n                'duration': estimated_duration,\n                'f0_mean_hz': 180.0,  # Typical teacher pitch\n                'f0_std_hz': 25.0,\n                'f0_min_hz': 120.0,\n                'f0_max_hz': 280.0,\n                'f0_range_hz': 160.0,\n                'jitter_local': 0.8,  # Typical for natural speech\n                'intensity_mean_db': 68.0,  # Good classroom volume\n                'intensity_std_db': 6.0,\n                'intensity_min_db': 55.0,\n                'intensity_max_db': 80.0,\n                'intensity_range_db': 25.0,\n                'shimmer_local': 4.5,  # Normal voice stability\n                'spectral_centroid_mean': 2200.0,  # Clear speech\n                'spectral_rolloff_mean': 4500.0\n            }\n            \n        except Exception as e:\n            logging.error(f\"Prosodic analysis error: {str(e)}\")\n            return self._get_basic_prosody_data()\n    \n    def _get_basic_prosody_data(self):\n        \"\"\"Return basic prosodic data when analysis is not available\"\"\"\n        return {\n            'duration': 0.0,\n            'f0_mean_hz': 150.0,  # Average human speech\n            'f0_std_hz': 20.0,\n            'f0_min_hz': 80.0,\n            'f0_max_hz': 300.0,\n            'f0_range_hz': 220.0,\n            'jitter_local': 0.5,\n            'intensity_mean_db': 65.0,\n            'intensity_std_db': 5.0,\n            'intensity_min_db': 50.0,\n            'intensity_max_db': 80.0,\n            'intensity_range_db': 30.0,\n            'shimmer_local': 3.0,\n            'spectral_centroid_mean': 2000.0,\n            'spectral_rolloff_mean': 4000.0\n        }\n    \n    def _calculate_speech_metrics(self, text, segments):\n        \"\"\"Calculate speech metrics from transcription\"\"\"\n        try:\n            # Word count and basic metrics\n            words = text.split()\n            word_count = len(words)\n            \n            # Calculate speech rate (WPM)\n            if segments and len(segments) > 0:\n                # Try to get duration from segments\n                try:\n                    last_segment = segments[-1]\n                    first_segment = segments[0]\n                    if hasattr(last_segment, 'end') and hasattr(first_segment, 'start'):\n                        duration_seconds = last_segment.end - first_segment.start\n                    else:\n                        duration_seconds = 60.0  # default estimate\n                except:\n                    duration_seconds = 60.0  # default estimate\n                    \n                wpm = (word_count / duration_seconds) * 60 if duration_seconds > 0 else 0\n            else:\n                wpm = word_count  # rough estimate\n            \n            # Count filler words\n            fillers = {}\n            text_lower = text.lower()\n            \n            for filler in self.spanish_fillers:\n                # Use word boundaries to match whole words\n                pattern = r'\\b' + re.escape(filler) + r'\\b'\n                matches = len(re.findall(pattern, text_lower))\n                if matches > 0:\n                    fillers[filler] = matches\n            \n            # Analyze pauses (basic estimation)\n            pauses = self._analyze_pauses_basic(text)\n            \n            return {\n                'word_count': word_count,\n                'wpm': round(wpm, 1),\n                'fillers': fillers,\n                'filler_count': sum(fillers.values()),\n                'filler_rate': round(sum(fillers.values()) / word_count * 100, 2) if word_count > 0 else 0,\n                'pauses': pauses\n            }\n            \n        except Exception as e:\n            logging.error(f\"Speech metrics calculation error: {str(e)}\")\n            return {\n                'word_count': 0,\n                'wpm': 0,\n                'fillers': {},\n                'filler_count': 0,\n                'filler_rate': 0,\n                'pauses': {'count': 0, 'avg_ms': 0, 'total_ms': 0}\n            }\n    \n    def _analyze_pauses_basic(self, text):\n        \"\"\"Basic pause analysis from text patterns\"\"\"\n        try:\n            # Count punctuation that indicates pauses\n            pause_indicators = ['.', ',', ';', ':', '!', '?']\n            pause_count = sum(text.count(indicator) for indicator in pause_indicators)\n            \n            # Estimate average pause duration based on punctuation type\n            estimated_avg_pause = 500  # milliseconds\n            estimated_total = pause_count * estimated_avg_pause\n            \n            return {\n                'count': pause_count,\n                'avg_ms': estimated_avg_pause,\n                'total_ms': estimated_total,\n                'max_ms': 1000,  # estimated\n                'min_ms': 200    # estimated\n            }\n            \n        except Exception as e:\n            logging.error(f\"Basic pause analysis error: {str(e)}\")\n            return {'count': 0, 'avg_ms': 0, 'total_ms': 0}","size_bytes":8551},"lesson_plan_agent.py":{"content":"import os\nimport json\nimport logging\nfrom openai import OpenAI\n\nclass LessonPlanAgent:\n    \"\"\"AI Agent specialized in pedagogical analysis of lesson plans using GPT-4o\"\"\"\n    \n    def __init__(self):\n        # Using GPT-4-turbo as requested\n        self.client = OpenAI(api_key=os.environ.get(\"OPENAI_API_KEY\"))\n        self.model = \"gpt-4-turbo\"\n    \n    def generate_pedagogical_feedback(self, analysis_data):\n        \"\"\"\n        Generate comprehensive pedagogical feedback for lesson plans\n        \n        Args:\n            analysis_data: Dict containing PDF structure analysis and educational context\n            \n        Returns:\n            Dict with structured pedagogical feedback\n        \"\"\"\n        try:\n            # Prepare the analysis summary for the AI\n            structure_analysis = analysis_data.get('structure_analysis', {})\n            educational_context = analysis_data.get('educational_context', {})\n            pdf_summary = analysis_data.get('pdf_summary', '')\n            \n            analysis_summary = self._prepare_lesson_plan_summary(structure_analysis, educational_context, pdf_summary)\n            \n            # Generate comprehensive pedagogical feedback\n            feedback_response = self.client.chat.completions.create(\n                model=self.model,\n                messages=[\n                    {\n                        \"role\": \"system\",\n                        \"content\": self._get_pedagogical_system_prompt()\n                    },\n                    {\n                        \"role\": \"user\",\n                        \"content\": f\"Analiza esta planeación de clase y proporciona retroalimentación pedagógica:\\n\\n{analysis_summary}\"\n                    }\n                ],\n                response_format={\"type\": \"json_object\"},\n                temperature=0.7\n            )\n            \n            content = feedback_response.choices[0].message.content\n            if content is None:\n                raise Exception(\"Empty response from AI model\")\n            feedback = json.loads(content)\n            \n            # Add metadata\n            feedback['analysis_timestamp'] = analysis_data.get('timestamp')\n            feedback['lesson_plan_agent_version'] = '1.0'\n            feedback['analysis_type'] = 'lesson_plan'\n            \n            return feedback\n            \n        except Exception as e:\n            logging.error(f\"Lesson Plan Agent error: {str(e)}\")\n            return self._get_error_feedback(str(e))\n    \n    def _prepare_lesson_plan_summary(self, structure_analysis, educational_context, pdf_summary):\n        \"\"\"Prepare a comprehensive summary for AI analysis\"\"\"\n        summary = []\n        \n        # Educational context\n        if educational_context:\n            summary.append(\"=== CONTEXTO EDUCATIVO ===\")\n            summary.append(f\"Materia: {educational_context.get('subject', 'No especificado')}\")\n            summary.append(f\"Grado: {educational_context.get('grade_level', 'No especificado')}\")\n            summary.append(f\"Tema de la clase: {educational_context.get('lesson_topic', 'No especificado')}\")\n            \n            if educational_context.get('lesson_duration'):\n                summary.append(f\"Duración planificada: {educational_context.get('lesson_duration')} minutos\")\n            \n            if educational_context.get('student_count'):\n                summary.append(f\"Número de estudiantes: {educational_context.get('student_count')}\")\n            \n            if educational_context.get('additional_context'):\n                summary.append(f\"Contexto adicional: {educational_context.get('additional_context')}\")\n            summary.append(\"\")\n        \n        # Structure analysis summary\n        if structure_analysis:\n            summary.append(\"=== ANÁLISIS ESTRUCTURAL ===\")\n            summary.append(f\"Completitud de la planeación: {structure_analysis.get('completeness_score', 0)}/100\")\n            summary.append(f\"Páginas analizadas: {structure_analysis.get('total_pages', 0)}\")\n            summary.append(f\"Total de palabras: {structure_analysis.get('total_words', 0)}\")\n            \n            sections_found = structure_analysis.get('sections_found', [])\n            if sections_found:\n                summary.append(f\"Secciones encontradas: {', '.join(sections_found)}\")\n            \n            # Learning objectives\n            objectives = structure_analysis.get('learning_objectives', [])\n            if objectives:\n                summary.append(f\"\\nObjetivos de aprendizaje ({len(objectives)} encontrados):\")\n                for i, obj in enumerate(objectives[:5], 1):\n                    summary.append(f\"  {i}. {obj}\")\n            \n            # Activities\n            activities_count = structure_analysis.get('activities_count', 0)\n            if activities_count > 0:\n                summary.append(f\"\\nActividades planificadas: {activities_count}\")\n            \n            # Assessment methods\n            assessment_methods = structure_analysis.get('assessment_methods', [])\n            if assessment_methods:\n                summary.append(f\"Métodos de evaluación: {', '.join(assessment_methods)}\")\n            \n            # Resources\n            resources = structure_analysis.get('resources_list', [])\n            if resources:\n                summary.append(f\"Recursos educativos: {', '.join(resources[:5])}\")\n            \n            # Time allocation\n            time_info = structure_analysis.get('time_allocation', {})\n            if time_info.get('total_minutes', 0) > 0:\n                summary.append(f\"Tiempo total estimado: {time_info['total_minutes']} minutos\")\n                summary.append(f\"Actividades con tiempo asignado: {time_info.get('activities_with_time', 0)}\")\n            \n            # Grade level indicators\n            grade_indicators = structure_analysis.get('grade_level_indicators', [])\n            if grade_indicators:\n                summary.append(f\"Indicadores de nivel detectados: {', '.join(grade_indicators)}\")\n        \n        # PDF content summary\n        if pdf_summary:\n            summary.append(\"\\n=== CONTENIDO DE LA PLANEACIÓN ===\")\n            summary.append(pdf_summary)\n        \n        return \"\\n\".join(summary)\n    \n    def _get_pedagogical_system_prompt(self):\n        \"\"\"Get the system prompt for pedagogical lesson plan analysis\"\"\"\n        return \"\"\"\nEres un Evaluador Pedagógico Oficial especializado en analizar planeaciones de clase según los criterios establecidos por el Ministerio de Educación. Tu rol es evaluar sistemáticamente cada planeación usando la FICHA DE OBSERVACIÓN PLANIFICACIÓN DE LA SESIÓN oficial.\n\nCRITERIOS DE EVALUACIÓN MINISTERIAL (12 CRITERIOS OFICIALES):\n\n1. DESARROLLO DE COMPETENCIAS\nLas actividades están alineadas explícitamente a una o más competencias del currículo nacional. Se describen los desempeños esperados.\n\n2. TRIANGULACIÓN (PROPÓSITO, ACTIVIDADES, EVALUACIÓN)\nSe evidencian conexiones claras entre: propósito de la sesión, secuencia de actividades de aprendizaje, y criterios de evaluación.\n\n3. CRITERIOS DE EVALUACIÓN CLAROS Y COMPRENSIBLES\nSe incluyen criterios coherentes, redactados en lenguaje claro, que permiten valorar el desempeño.\n\n4. PROCESOS DIDÁCTICOS (ÁREA ESPECÍFICA)\nSe integran los procesos didácticos del área según la competencia a desarrollar.\n\n5. METACOGNICIÓN CONSTANTE\nSe incluyen momentos planificados para reflexionar sobre el propio aprendizaje (antes, durante o después de las actividades).\n\n6. SECUENCIA COHERENTE DE ACTIVIDADES\nLas actividades tienen una secuencia lógica y gradual. Se observa relación entre los momentos y progresión hacia el logro de la competencia.\n\n7. TIEMPOS COHERENTES Y VIABLES\nEl tiempo estimado por actividad es realista y responde a la complejidad de las tareas.\n\n8. EVALUACIÓN FORMATIVA PRESENTE\nHay momentos o estrategias para recoger evidencias del aprendizaje durante el proceso (rúbricas, listas de cotejo, retroalimentación).\n\n9. PRINCIPIOS EBC – AGENCIA\nSe promueve la voz, elección y protagonismo del estudiante (ej.: eligen temas, formas de trabajar, reflexionan sobre lo aprendido).\n\n10. PRINCIPIOS EBC - EVALUACIÓN\nSe consideran formas diversas de demostrar el aprendizaje y se evita el error de medición (ej.: variedad de productos, revisión del progreso).\n\n11. PRINCIPIOS EBC - DIMENSIONES DE INSTRUCCIÓN\nLa planificación considera agrupamientos diversos (grupal, pares, 1:1), alta participación y expectativas, uso de recursos variados.\n\n12. INCLUSIÓN DE RECURSOS SIGNIFICATIVOS Y CONTEXTUALIZADOS\nInclusión de recursos significativos y contextualizados según las necesidades de los estudiantes.\n\nFORMATO DE SALIDA (JSON):\n{\n  \"overall_score\": 1-100,\n  \"summary\": \"Evaluación general según criterios ministeriales en español\",\n  \"strengths\": [\"Lista de 2-3 fortalezas clave identificadas\"],\n  \"areas_for_improvement\": [\"Lista de 2-3 áreas específicas de mejora\"],\n  \"detailed_analysis\": {\n    \"desarrollo_competencias\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de alineación a competencias del currículo nacional y descripción de desempeños\",\n      \"recommendations\": [\"Sugerencias específicas para mejorar alineación a competencias\"]\n    },\n    \"triangulacion\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de conexiones entre propósito, actividades y evaluación\",\n      \"recommendations\": [\"Sugerencias para mejorar la triangulación\"]\n    },\n    \"criterios_evaluacion\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de claridad y comprensibilidad de criterios de evaluación\",\n      \"recommendations\": [\"Sugerencias para criterios más claros\"]\n    },\n    \"procesos_didacticos\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de integración de procesos didácticos del área específica\",\n      \"recommendations\": [\"Sugerencias para mejorar procesos didácticos\"]\n    },\n    \"metacognicion\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de momentos de reflexión sobre el aprendizaje planificados\",\n      \"recommendations\": [\"Sugerencias para fortalecer la metacognición\"]\n    },\n    \"secuencia_actividades\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de secuencia lógica y progresión hacia competencias\",\n      \"recommendations\": [\"Sugerencias para mejorar la secuencia\"]\n    },\n    \"tiempos_viables\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de realismo y coherencia en la distribución del tiempo\",\n      \"recommendations\": [\"Sugerencias para optimizar tiempos\"]\n    },\n    \"evaluacion_formativa\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de estrategias para recoger evidencias durante el proceso\",\n      \"recommendations\": [\"Sugerencias para fortalecer evaluación formativa\"]\n    },\n    \"principios_ebc_agencia\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de promoción de voz, elección y protagonismo estudiantil\",\n      \"recommendations\": [\"Sugerencias para fortalecer agencia estudiantil\"]\n    },\n    \"principios_ebc_evaluacion\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de formas diversas de demostrar aprendizaje\",\n      \"recommendations\": [\"Sugerencias para diversificar evaluación\"]\n    },\n    \"principios_ebc_instruccion\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis de agrupamientos diversos, participación y recursos variados\",\n      \"recommendations\": [\"Sugerencias para dimensiones de instrucción\"]\n    },\n    \"recursos_contextualizados\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de significatividad y contextualización de recursos\",\n      \"recommendations\": [\"Sugerencias para recursos más contextualizados\"]\n    }\n  },\n  \"criterios_ministeriales\": {\n    \"desarrollo_competencias\": \"no_cumple|parcial|cumple|supera\",\n    \"triangulacion\": \"no_cumple|parcial|cumple|supera\",\n    \"criterios_evaluacion\": \"no_cumple|parcial|cumple|supera\",\n    \"procesos_didacticos\": \"no_cumple|parcial|cumple|supera\",\n    \"metacognicion\": \"no_cumple|parcial|cumple|supera\",\n    \"secuencia_actividades\": \"no_cumple|parcial|cumple|supera\",\n    \"tiempos_viables\": \"no_cumple|parcial|cumple|supera\",\n    \"evaluacion_formativa\": \"no_cumple|parcial|cumple|supera\",\n    \"principios_ebc_agencia\": \"no_cumple|parcial|cumple|supera\",\n    \"principios_ebc_evaluacion\": \"no_cumple|parcial|cumple|supera\",\n    \"principios_ebc_instruccion\": \"no_cumple|parcial|cumple|supera\",\n    \"recursos_contextualizados\": \"no_cumple|parcial|cumple|supera\"\n  },\n  \"action_plan\": [\"3-5 elementos de acción priorizados según criterios ministeriales\"],\n  \"observaciones_oficiales\": [\"2-3 observaciones específicas según ficha ministerial\"],\n  \"recomendaciones_normativas\": [\"2-3 recomendaciones para cumplir estándares ministeriales\"]\n}\n\nTONO: Evaluativo oficial, profesional, constructivo. Enfocado en el cumplimiento de estándares ministeriales mientras proporciona orientación específica para la mejora. Utiliza terminología oficial pero accesible.\n\nIMPORTANTE:\n- Todas las respuestas en español\n- Evalúa estrictamente según los 12 criterios ministeriales oficiales\n- Proporciona evidencias específicas de la planeación analizada\n- Sugiere mejoras concretas para cumplir cada criterio ministerial\n- Enfócate en el cumplimiento normativo y la calidad pedagógica\n- Reconoce cuando se cumplen los estándares ministeriales\n- Si un criterio no se cumple, explica claramente qué falta\n- Proporciona ejemplos específicos de cómo mejorar cada criterio\n- Considera el marco curricular nacional en cada evaluación\n\"\"\"\n    \n    def _get_error_feedback(self, error_message):\n        \"\"\"Return error feedback structure for lesson plans using ministerial criteria\"\"\"\n        return {\n            \"overall_score\": 0,\n            \"summary\": \"No se pudo completar el análisis pedagógico según criterios ministeriales debido a un error técnico.\",\n            \"strengths\": [],\n            \"areas_for_improvement\": [\"Error técnico impidió el análisis según ficha ministerial\"],\n            \"detailed_analysis\": {\n                \"desarrollo_competencias\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"triangulacion\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"criterios_evaluacion\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"procesos_didacticos\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"metacognicion\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"secuencia_actividades\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"tiempos_viables\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"evaluacion_formativa\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"principios_ebc_agencia\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"principios_ebc_evaluacion\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"principios_ebc_instruccion\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []},\n                \"recursos_contextualizados\": {\"score\": 0, \"feedback\": \"Error en el análisis\", \"recommendations\": []}\n            },\n            \"criterios_ministeriales\": {\n                \"desarrollo_competencias\": \"no_cumple\",\n                \"triangulacion\": \"no_cumple\",\n                \"criterios_evaluacion\": \"no_cumple\",\n                \"procesos_didacticos\": \"no_cumple\",\n                \"metacognicion\": \"no_cumple\",\n                \"secuencia_actividades\": \"no_cumple\",\n                \"tiempos_viables\": \"no_cumple\",\n                \"evaluacion_formativa\": \"no_cumple\",\n                \"principios_ebc_agencia\": \"no_cumple\",\n                \"principios_ebc_evaluacion\": \"no_cumple\",\n                \"principios_ebc_instruccion\": \"no_cumple\",\n                \"recursos_contextualizados\": \"no_cumple\"\n            },\n            \"action_plan\": [\"Por favor, intenta subir el archivo PDF nuevamente\"],\n            \"observaciones_oficiales\": [\"Error técnico impidió evaluación ministerial\"],\n            \"recomendaciones_normativas\": [\"Reintenta el análisis con archivo válido\"],\n            \"error\": error_message,\n            \"lesson_plan_agent_version\": \"2.0_ministerial\"\n        }","size_bytes":16460},"main.py":{"content":"from app import app\nimport routes  # Import routes to register them with the app\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n","size_bytes":160},"models.py":{"content":"from app import db\nfrom datetime import datetime\nimport json\n\nclass ClassroomAnalysis(db.Model):\n    \"\"\"Unified model for both audio and PDF lesson analysis\"\"\"\n    id = db.Column(db.Integer, primary_key=True)\n    filename = db.Column(db.String(255), nullable=False)\n    original_filename = db.Column(db.String(255), nullable=False)\n    upload_timestamp = db.Column(db.DateTime, default=datetime.utcnow)\n    analysis_timestamp = db.Column(db.DateTime)\n    \n    # Analysis type\n    analysis_type = db.Column(db.String(20), default='audio')  # 'audio' or 'pdf'\n    \n    # Educational context (shared)\n    subject = db.Column(db.String(100))  # Materia/asignatura\n    grade_level = db.Column(db.String(50))  # Grado escolar\n    lesson_topic = db.Column(db.String(255))  # Tema de la clase\n    additional_context = db.Column(db.Text)  # Contexto adicional\n    \n    # PDF-specific context\n    lesson_duration = db.Column(db.Integer)  # Duration in minutes\n    student_count = db.Column(db.Integer)  # Number of students\n    learning_objectives = db.Column(db.Text)  # Extracted learning objectives\n    \n    # Audio-specific results (nullable for PDF analysis)\n    transcription_text = db.Column(db.Text)\n    transcription_data = db.Column(db.Text)  # JSON string for detailed transcription\n    prosody_data = db.Column(db.Text)  # JSON string for prosodic metrics\n    \n    # PDF-specific results (nullable for audio analysis)\n    pdf_text_content = db.Column(db.Text)  # Extracted PDF text\n    lesson_plan_structure = db.Column(db.Text)  # JSON string for lesson structure analysis\n    pedagogical_analysis = db.Column(db.Text)  # JSON string for pedagogical feedback\n    \n    # AI feedback (shared for both types)\n    ric_feedback = db.Column(db.Text)  # JSON string for AI-generated feedback\n    \n    # Analysis status\n    status = db.Column(db.String(50), default='uploaded')  # uploaded, processing, completed, error\n    error_message = db.Column(db.Text)\n    \n    def get_transcription_data(self):\n        \"\"\"Parse transcription data from JSON\"\"\"\n        if self.transcription_data:\n            try:\n                return json.loads(self.transcription_data)\n            except json.JSONDecodeError:\n                return {}\n        return {}\n    \n    def set_transcription_data(self, data):\n        \"\"\"Store transcription data as JSON\"\"\"\n        self.transcription_data = json.dumps(data)\n    \n    def get_prosody_data(self):\n        \"\"\"Parse prosody data from JSON\"\"\"\n        if self.prosody_data:\n            try:\n                return json.loads(self.prosody_data)\n            except json.JSONDecodeError:\n                return {}\n        return {}\n    \n    def set_prosody_data(self, data):\n        \"\"\"Store prosody data as JSON\"\"\"\n        self.prosody_data = json.dumps(data)\n    \n    def get_ric_feedback(self):\n        \"\"\"Parse RIC feedback from JSON\"\"\"\n        if self.ric_feedback:\n            try:\n                return json.loads(self.ric_feedback)\n            except json.JSONDecodeError:\n                return {}\n        return {}\n    \n    def set_ric_feedback(self, data):\n        \"\"\"Store RIC feedback as JSON\"\"\"\n        self.ric_feedback = json.dumps(data)\n    \n    def get_lesson_plan_structure(self):\n        \"\"\"Parse lesson plan structure from JSON\"\"\"\n        if self.lesson_plan_structure:\n            try:\n                return json.loads(self.lesson_plan_structure)\n            except json.JSONDecodeError:\n                return {}\n        return {}\n    \n    def set_lesson_plan_structure(self, data):\n        \"\"\"Store lesson plan structure as JSON\"\"\"\n        self.lesson_plan_structure = json.dumps(data)\n    \n    def get_pedagogical_analysis(self):\n        \"\"\"Parse pedagogical analysis from JSON\"\"\"\n        if self.pedagogical_analysis:\n            try:\n                return json.loads(self.pedagogical_analysis)\n            except json.JSONDecodeError:\n                return {}\n        return {}\n    \n    def set_pedagogical_analysis(self, data):\n        \"\"\"Store pedagogical analysis as JSON\"\"\"\n        self.pedagogical_analysis = json.dumps(data)\n    \n    def get_educational_context(self):\n        \"\"\"Get educational context as dictionary\"\"\"\n        context = {\n            'subject': self.subject or 'General',\n            'grade_level': self.grade_level or 'No especificado',\n            'lesson_topic': self.lesson_topic or 'Tema general',\n            'additional_context': self.additional_context or '',\n            'analysis_type': self.analysis_type or 'audio'\n        }\n        \n        # Add PDF-specific context if applicable\n        if self.analysis_type == 'pdf':\n            context.update({\n                'lesson_duration': self.lesson_duration,\n                'student_count': self.student_count,\n                'learning_objectives': self.learning_objectives or ''\n            })\n        \n        return context\n    \n    def is_audio_analysis(self):\n        \"\"\"Check if this is an audio analysis\"\"\"\n        return self.analysis_type == 'audio'\n    \n    def is_pdf_analysis(self):\n        \"\"\"Check if this is a PDF analysis\"\"\"\n        return self.analysis_type == 'pdf'\n\n\n# Keep backward compatibility alias\nAudioAnalysis = ClassroomAnalysis\n","size_bytes":5199},"pdf_processor.py":{"content":"import re\nimport logging\nfrom io import BytesIO\nfrom PyPDF2 import PdfReader\nfrom typing import Dict, List, Optional\n\nclass PDFProcessor:\n    \"\"\"PDF processing for lesson plan text extraction and analysis\"\"\"\n    \n    def __init__(self):\n        # Common section headers in Spanish lesson plans\n        self.section_patterns = {\n            'objetivos': [\n                r'objetivos?\\s+(?:de\\s+)?(?:aprendizaje|específicos?|generales?)',\n                r'propósitos?\\s+(?:de\\s+la\\s+)?(?:clase|lección)',\n                r'metas?\\s+(?:de\\s+)?aprendizaje',\n                r'qué\\s+aprenderán',\n                r'logros?\\s+esperados?'\n            ],\n            'contenidos': [\n                r'contenidos?\\s+(?:temáticos?|curriculares?)?',\n                r'temas?\\s+(?:a\\s+)?(?:desarrollar|tratar)',\n                r'materias?\\s+(?:de\\s+estudio)?',\n                r'conceptos?\\s+(?:clave|principales?)'\n            ],\n            'actividades': [\n                r'actividades?\\s+(?:de\\s+)?(?:aprendizaje|enseñanza)?',\n                r'estrategias?\\s+(?:didácticas?|metodológicas?)',\n                r'desarrollo\\s+(?:de\\s+la\\s+)?clase',\n                r'secuencia\\s+didáctica',\n                r'metodología'\n            ],\n            'evaluacion': [\n                r'evaluación\\s+(?:de\\s+)?(?:aprendizajes?)?',\n                r'assessment',\n                r'criterios?\\s+de\\s+evaluación',\n                r'instrumentos?\\s+de\\s+evaluación',\n                r'rúbricas?'\n            ],\n            'recursos': [\n                r'recursos?\\s+(?:didácticos?|educativos?)?',\n                r'materiales?\\s+(?:educativos?|de\\s+apoyo)?',\n                r'herramientas?',\n                r'tecnología\\s+educativa'\n            ],\n            'tiempo': [\n                r'tiempo\\s+(?:estimado|asignado)',\n                r'duración\\s+(?:de\\s+la\\s+)?(?:clase|actividad)',\n                r'cronograma',\n                r'distribución\\s+del\\s+tiempo'\n            ]\n        }\n        \n        # Common grade level indicators\n        self.grade_indicators = {\n            'preescolar': ['preescolar', 'jardín', 'kinder', 'inicial'],\n            'primaria_baja': ['1°', '2°', '3°', 'primero', 'segundo', 'tercero', 'grado'],\n            'primaria_alta': ['4°', '5°', '6°', 'cuarto', 'quinto', 'sexto'],\n            'secundaria': ['7°', '8°', '9°', 'séptimo', 'octavo', 'noveno', 'secundaria'],\n            'bachillerato': ['10°', '11°', '12°', 'décimo', 'once', 'doce', 'bachillerato', 'preparatoria']\n        }\n\n    def extract_text_from_pdf(self, pdf_file_path: str) -> str:\n        \"\"\"\n        Extract text from PDF file\n        \n        Args:\n            pdf_file_path: Path to the PDF file\n            \n        Returns:\n            Extracted text content\n        \"\"\"\n        try:\n            logging.info(f\"Starting PDF text extraction from {pdf_file_path}\")\n            \n            with open(pdf_file_path, 'rb') as file:\n                reader = PdfReader(file)\n                \n                text_content = []\n                \n                for page_num, page in enumerate(reader.pages):\n                    try:\n                        page_text = page.extract_text()\n                        if page_text.strip():\n                            text_content.append(f\"--- Página {page_num + 1} ---\\n{page_text}\")\n                    except Exception as e:\n                        logging.warning(f\"Error extracting text from page {page_num + 1}: {str(e)}\")\n                        continue\n                \n                full_text = \"\\n\\n\".join(text_content)\n                \n                if not full_text.strip():\n                    raise Exception(\"No se pudo extraer texto del PDF\")\n                \n                logging.info(f\"Successfully extracted {len(full_text)} characters from PDF\")\n                return full_text\n                \n        except Exception as e:\n            logging.error(f\"PDF text extraction error: {str(e)}\")\n            raise e\n\n    def analyze_lesson_plan_structure(self, text: str) -> Dict:\n        \"\"\"\n        Analyze lesson plan structure from extracted text\n        \n        Args:\n            text: Extracted PDF text\n            \n        Returns:\n            Dictionary with structured lesson plan analysis\n        \"\"\"\n        try:\n            logging.info(\"Starting lesson plan structure analysis\")\n            \n            # Clean and normalize text\n            cleaned_text = self._clean_text(text)\n            \n            # Extract sections\n            sections = self._extract_sections(cleaned_text)\n            \n            # Analyze content structure\n            structure_analysis = {\n                'total_words': len(cleaned_text.split()),\n                'total_pages': text.count('--- Página'),\n                'sections_found': list(sections.keys()),\n                'sections_content': sections,\n                'grade_level_indicators': self._detect_grade_level(cleaned_text),\n                'learning_objectives': self._extract_learning_objectives(sections.get('objetivos', '')),\n                'activities_count': self._count_activities(sections.get('actividades', '')),\n                'assessment_methods': self._extract_assessment_methods(sections.get('evaluacion', '')),\n                'resources_list': self._extract_resources(sections.get('recursos', '')),\n                'time_allocation': self._extract_time_info(sections.get('tiempo', '') + sections.get('actividades', ''))\n            }\n            \n            # Calculate completeness score\n            structure_analysis['completeness_score'] = self._calculate_completeness_score(sections)\n            \n            logging.info(\"Lesson plan structure analysis completed\")\n            return structure_analysis\n            \n        except Exception as e:\n            logging.error(f\"Lesson plan structure analysis error: {str(e)}\")\n            return self._get_basic_structure_analysis()\n\n    def _clean_text(self, text: str) -> str:\n        \"\"\"Clean and normalize extracted text\"\"\"\n        # Remove excessive whitespace and normalize\n        text = re.sub(r'\\s+', ' ', text)\n        text = re.sub(r'\\n+', '\\n', text)\n        # Remove page markers for content analysis\n        text = re.sub(r'--- Página \\d+ ---', '', text)\n        return text.strip()\n\n    def _extract_sections(self, text: str) -> Dict[str, str]:\n        \"\"\"Extract different sections from the lesson plan\"\"\"\n        sections = {}\n        text_lower = text.lower()\n        \n        for section_name, patterns in self.section_patterns.items():\n            section_content = \"\"\n            \n            for pattern in patterns:\n                match = re.search(pattern, text_lower)\n                if match:\n                    start_pos = match.start()\n                    # Find the end of this section (next section or end of text)\n                    end_pos = len(text)\n                    \n                    # Look for the next section\n                    next_sections = []\n                    for other_section, other_patterns in self.section_patterns.items():\n                        if other_section != section_name:\n                            for other_pattern in other_patterns:\n                                other_match = re.search(other_pattern, text_lower[start_pos + 50:])\n                                if other_match:\n                                    next_sections.append(start_pos + 50 + other_match.start())\n                    \n                    if next_sections:\n                        end_pos = min(next_sections)\n                    \n                    section_content = text[start_pos:end_pos].strip()\n                    break\n            \n            if section_content:\n                sections[section_name] = section_content[:1000]  # Limit to prevent excessive data\n        \n        return sections\n\n    def _detect_grade_level(self, text: str) -> List[str]:\n        \"\"\"Detect grade level indicators in the text\"\"\"\n        detected_levels = []\n        text_lower = text.lower()\n        \n        for level, indicators in self.grade_indicators.items():\n            for indicator in indicators:\n                if indicator in text_lower:\n                    detected_levels.append(level)\n                    break\n        \n        return detected_levels\n\n    def _extract_learning_objectives(self, objectives_text: str) -> List[str]:\n        \"\"\"Extract learning objectives from objectives section\"\"\"\n        objectives = []\n        \n        if not objectives_text:\n            return objectives\n        \n        # Look for numbered or bulleted objectives\n        patterns = [\n            r'(?:^|\\n)\\s*[\\d\\-\\*•]\\s*(.+?)(?=\\n|$)',\n            r'(?:^|\\n)\\s*(?:que|el estudiante|los estudiantes?)\\s+(.+?)(?=\\n|$)',\n            r'(?:^|\\n)\\s*(?:identificar|reconocer|comprender|analizar|aplicar|evaluar)\\s+(.+?)(?=\\n|$)'\n        ]\n        \n        for pattern in patterns:\n            matches = re.findall(pattern, objectives_text, re.MULTILINE | re.IGNORECASE)\n            objectives.extend([match.strip() for match in matches if len(match.strip()) > 10])\n        \n        return objectives[:5]  # Limit to top 5 objectives\n\n    def _count_activities(self, activities_text: str) -> int:\n        \"\"\"Count the number of activities in the activities section\"\"\"\n        if not activities_text:\n            return 0\n        \n        # Count numbered activities, bullet points, or activity indicators\n        activity_patterns = [\n            r'(?:^|\\n)\\s*[\\d\\-\\*•]\\s*(?:actividad|ejercicio|tarea)',\n            r'(?:primera|segunda|tercera|cuarta|quinta)\\s+(?:actividad|fase)',\n            r'(?:inicio|desarrollo|cierre)\\s*:',\n            r'(?:^|\\n)\\s*(?:paso|etapa)\\s+\\d+'\n        ]\n        \n        total_count = 0\n        for pattern in activity_patterns:\n            matches = re.findall(pattern, activities_text, re.MULTILINE | re.IGNORECASE)\n            total_count += len(matches)\n        \n        return max(total_count, 1) if activities_text.strip() else 0\n\n    def _extract_assessment_methods(self, evaluation_text: str) -> List[str]:\n        \"\"\"Extract assessment methods from evaluation section\"\"\"\n        methods = []\n        \n        if not evaluation_text:\n            return methods\n        \n        assessment_keywords = [\n            'observación', 'rúbrica', 'lista de cotejo', 'portafolio',\n            'examen', 'prueba', 'quiz', 'proyecto', 'presentación',\n            'autoevaluación', 'coevaluación', 'heteroevaluación'\n        ]\n        \n        text_lower = evaluation_text.lower()\n        for keyword in assessment_keywords:\n            if keyword in text_lower:\n                methods.append(keyword.title())\n        \n        return methods\n\n    def _extract_resources(self, resources_text: str) -> List[str]:\n        \"\"\"Extract educational resources from resources section\"\"\"\n        resources = []\n        \n        if not resources_text:\n            return resources\n        \n        # Look for resource items\n        resource_patterns = [\n            r'(?:^|\\n)\\s*[\\d\\-\\*•]\\s*(.+?)(?=\\n|$)',\n            r'(?:libro|texto|material|recurso|herramienta)\\s*:?\\s*(.+?)(?=\\n|$)'\n        ]\n        \n        for pattern in resource_patterns:\n            matches = re.findall(pattern, resources_text, re.MULTILINE | re.IGNORECASE)\n            resources.extend([match.strip() for match in matches if len(match.strip()) > 3])\n        \n        return resources[:10]  # Limit to top 10 resources\n\n    def _extract_time_info(self, time_text: str) -> Dict[str, int]:\n        \"\"\"Extract time allocation information\"\"\"\n        time_info = {\n            'total_minutes': 0,\n            'activities_with_time': 0,\n            'time_distribution': {}\n        }\n        \n        if not time_text:\n            return time_info\n        \n        # Look for time patterns\n        time_patterns = [\n            r'(\\d+)\\s*(?:minutos?|min\\.?)',\n            r'(\\d+)\\s*(?:horas?|hr\\.?)',\n            r'(\\d+)\\s*(?:hrs?\\.?)'\n        ]\n        \n        total_minutes = 0\n        activities_with_time = 0\n        \n        for pattern in time_patterns:\n            matches = re.findall(pattern, time_text, re.IGNORECASE)\n            for match in matches:\n                minutes = int(match)\n                if 'hora' in pattern or 'hr' in pattern:\n                    minutes *= 60\n                total_minutes += minutes\n                activities_with_time += 1\n        \n        time_info['total_minutes'] = total_minutes\n        time_info['activities_with_time'] = activities_with_time\n        \n        return time_info\n\n    def _calculate_completeness_score(self, sections: Dict[str, str]) -> int:\n        \"\"\"Calculate how complete the lesson plan is based on sections found\"\"\"\n        essential_sections = ['objetivos', 'contenidos', 'actividades']\n        recommended_sections = ['evaluacion', 'recursos', 'tiempo']\n        \n        essential_found = sum(1 for section in essential_sections if section in sections and sections[section].strip())\n        recommended_found = sum(1 for section in recommended_sections if section in sections and sections[section].strip())\n        \n        # Essential sections worth 70%, recommended worth 30%\n        essential_score = (essential_found / len(essential_sections)) * 70\n        recommended_score = (recommended_found / len(recommended_sections)) * 30\n        \n        return int(essential_score + recommended_score)\n\n    def _get_basic_structure_analysis(self):\n        \"\"\"Return basic structure analysis when detailed analysis fails\"\"\"\n        return {\n            'total_words': 0,\n            'total_pages': 0,\n            'sections_found': [],\n            'sections_content': {},\n            'grade_level_indicators': [],\n            'learning_objectives': [],\n            'activities_count': 0,\n            'assessment_methods': [],\n            'resources_list': [],\n            'time_allocation': {'total_minutes': 0, 'activities_with_time': 0},\n            'completeness_score': 0\n        }\n\n    def get_analysis_summary(self, structure_analysis: Dict) -> str:\n        \"\"\"Generate a summary of the PDF analysis for AI processing\"\"\"\n        summary = []\n        \n        summary.append(\"=== ANÁLISIS DE PLANEACIÓN (PDF) ===\")\n        summary.append(f\"Páginas analizadas: {structure_analysis.get('total_pages', 0)}\")\n        summary.append(f\"Total de palabras: {structure_analysis.get('total_words', 0)}\")\n        summary.append(f\"Puntuación de completitud: {structure_analysis.get('completeness_score', 0)}/100\")\n        summary.append(\"\")\n        \n        sections_found = structure_analysis.get('sections_found', [])\n        if sections_found:\n            summary.append(f\"Secciones encontradas: {', '.join(sections_found)}\")\n        \n        objectives = structure_analysis.get('learning_objectives', [])\n        if objectives:\n            summary.append(f\"Objetivos de aprendizaje detectados: {len(objectives)}\")\n            for i, obj in enumerate(objectives[:3], 1):\n                summary.append(f\"  {i}. {obj[:100]}...\")\n        \n        activities_count = structure_analysis.get('activities_count', 0)\n        if activities_count > 0:\n            summary.append(f\"Actividades planificadas: {activities_count}\")\n        \n        assessment_methods = structure_analysis.get('assessment_methods', [])\n        if assessment_methods:\n            summary.append(f\"Métodos de evaluación: {', '.join(assessment_methods)}\")\n        \n        time_info = structure_analysis.get('time_allocation', {})\n        if time_info.get('total_minutes', 0) > 0:\n            summary.append(f\"Tiempo total estimado: {time_info['total_minutes']} minutos\")\n        \n        return \"\\n\".join(summary)","size_bytes":15736},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"email-validator>=2.2.0\",\n    \"flask>=3.1.1\",\n    \"flask-sqlalchemy>=3.1.1\",\n    \"gunicorn>=23.0.0\",\n    \"openai>=1.99.9\",\n    \"psycopg2-binary>=2.9.10\",\n    \"pypdf2>=3.0.1\",\n    \"sqlalchemy>=2.0.43\",\n    \"werkzeug>=3.1.3\",\n]\n","size_bytes":372},"replit.md":{"content":"# RIC - Reflective Instruction Coach\n\n## Overview\n\nRIC (Reflective Instruction Coach) is an educational technology application that analyzes classroom teaching audio recordings to provide intelligent feedback to educators. The system uses advanced AI technologies including speech transcription, prosodic analysis, and GPT-4 powered educational feedback to help teachers improve their instructional delivery, clarity, and teaching techniques.\n\nThe application focuses on Spanish-language classroom analysis, providing comprehensive insights into teaching effectiveness through automated audio processing and AI-generated recommendations.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Template Engine**: Jinja2 templates with Bootstrap 5 for responsive UI\n- **Client-Side Framework**: Vanilla JavaScript with modern ES6+ features and Web Audio API\n- **Styling**: Custom CSS with Bootstrap components and Feather icons\n- **File Upload**: Drag-and-drop interface supporting multiple audio formats (MP3, WAV, M4A, OGG, FLAC)\n- **Audio Recording**: Real-time microphone recording with Web Audio API, live timer, and playback preview\n- **Real-time Updates**: Auto-refresh mechanism for processing status updates\n\n### Backend Architecture\n- **Web Framework**: Flask with SQLAlchemy ORM for database operations\n- **File Processing**: Secure file upload handling with size limits (100MB max)\n- **Audio Processing Pipeline**: Multi-stage analysis including transcription and prosodic analysis\n- **AI Integration**: OpenAI GPT-4o for educational feedback generation\n- **Database**: SQLite for development with PostgreSQL compatibility\n- **Session Management**: Flask sessions with configurable secret keys\n\n### Core Components\n\n#### Audio Processing Module (`audio_processor.py`)\n- **Transcription**: OpenAI Whisper API integration optimized for Spanish language\n- **Prosodic Analysis**: Parselmouth (Praat) and librosa for speech pattern analysis\n- **Educational Metrics**: Specialized calculations for filler word detection and speech quality\n\n#### RIC AI Agent (`ric_agent.py`)\n- **Model**: GPT-4-turbo (updated from GPT-4o as requested)\n- **Feedback Generation**: Structured JSON responses for educational recommendations\n- **Educational Focus**: Specialized prompts for classroom instruction analysis\n\n#### Lesson Plan Agent (`lesson_plan_agent.py`)\n- **Model**: GPT-4-turbo (updated from GPT-4o as requested)  \n- **Evaluation Framework**: Official Ministry of Education criteria (12 ministerial standards)\n- **Assessment Structure**: Ficha de Observación Planificación de la Sesión oficial\n- **Standards Compliance**: Evaluates according to national curriculum requirements\n\n#### Data Models (`models.py`)\n- **AudioAnalysis**: Primary entity storing upload metadata, transcription results, prosodic data, and AI feedback\n- **JSON Storage**: Flexible schema using JSON columns for complex analysis data\n- **Status Tracking**: Complete workflow state management (uploaded → processing → completed/error)\n\n### Database Design\n- **Primary Table**: AudioAnalysis with columns for file metadata, analysis results, and status tracking\n- **JSON Fields**: Structured storage for transcription data, prosodic metrics, and AI feedback\n- **Timestamp Tracking**: Upload and analysis completion timestamps\n- **Error Handling**: Error message storage for failed analyses\n\n### Processing Workflow\n1. **File Upload**: Secure file handling with format validation\n2. **Database Record Creation**: Initial record with 'uploaded' status\n3. **Transcription Processing**: Whisper API call with Spanish optimization\n4. **Prosodic Analysis**: Speech pattern analysis using Praat algorithms\n5. **AI Feedback Generation**: GPT-4o analysis of educational effectiveness\n6. **Status Updates**: Progressive status tracking throughout pipeline\n\n## External Dependencies\n\n### AI and Machine Learning Services\n- **OpenAI API**: Whisper for transcription, GPT-4o for educational feedback\n- **Parselmouth**: Python interface to Praat for prosodic analysis\n- **librosa**: Audio signal processing and feature extraction\n\n### Web Framework and Database\n- **Flask**: Web application framework with SQLAlchemy ORM\n- **SQLite**: Development database (PostgreSQL compatible)\n- **Werkzeug**: WSGI utilities and secure filename handling\n\n### Frontend Libraries\n- **Bootstrap 5**: CSS framework for responsive design\n- **Feather Icons**: Icon library for UI components\n- **Chart.js**: Data visualization for analysis results\n\n### Audio Processing Libraries\n- **Praat**: Phonetic analysis software (via Parselmouth)\n- **NumPy**: Numerical computing for audio signal processing\n\n### Environment Configuration\n- **Environment Variables**: OpenAI API key, database URL, session secrets\n- **File Storage**: Local filesystem with configurable upload directory\n- **Proxy Support**: ProxyFix middleware for deployment environments","size_bytes":4967},"ric_agent.py":{"content":"import os\nimport json\nimport logging\nfrom openai import OpenAI\n\nclass RICAgent:\n    \"\"\"RIC AI Agent - Educational feedback system using GPT-4 Turbo\"\"\"\n    \n    def __init__(self):\n        # Using GPT-4-turbo as requested by the user\n        self.client = OpenAI(api_key=os.environ.get(\"OPENAI_API_KEY\"))\n        self.model = \"gpt-4-turbo\"\n    \n    def generate_educational_feedback(self, analysis_data):\n        \"\"\"\n        Generate comprehensive educational feedback based on transcription and prosodic analysis\n        \n        Args:\n            analysis_data: Dict containing transcription and prosody data\n            \n        Returns:\n            Dict with structured educational feedback\n        \"\"\"\n        try:\n            # Prepare the analysis summary for the AI\n            transcription = analysis_data.get('transcription', {})\n            prosody = analysis_data.get('prosody', {})\n            educational_context = analysis_data.get('educational_context', {})\n            \n            analysis_summary = self._prepare_analysis_summary(transcription, prosody, educational_context)\n            \n            # Generate comprehensive feedback\n            feedback_response = self.client.chat.completions.create(\n                model=self.model,\n                messages=[\n                    {\n                        \"role\": \"system\",\n                        \"content\": self._get_system_prompt()\n                    },\n                    {\n                        \"role\": \"user\",\n                        \"content\": f\"Analyze this classroom teaching session and provide educational feedback:\\n\\n{analysis_summary}\"\n                    }\n                ],\n                response_format={\"type\": \"json_object\"},\n                temperature=0.7\n            )\n            \n            content = feedback_response.choices[0].message.content\n            if content is None:\n                raise Exception(\"Empty response from AI model\")\n            feedback = json.loads(content)\n            \n            # Add metadata\n            feedback['analysis_timestamp'] = analysis_data.get('timestamp')\n            feedback['ric_version'] = '1.0'\n            \n            return feedback\n            \n        except Exception as e:\n            logging.error(f\"RIC Agent error: {str(e)}\")\n            return self._get_error_feedback(str(e))\n    \n    def _prepare_analysis_summary(self, transcription, prosody, educational_context=None):\n        \"\"\"Prepare a summary of the analysis data for the AI\"\"\"\n        summary = []\n        \n        # Educational context summary\n        if educational_context:\n            summary.append(\"=== CONTEXTO EDUCATIVO ===\")\n            summary.append(f\"Materia: {educational_context.get('subject', 'No especificado')}\")\n            summary.append(f\"Grado: {educational_context.get('grade_level', 'No especificado')}\")\n            summary.append(f\"Tema de la clase: {educational_context.get('lesson_topic', 'No especificado')}\")\n            if educational_context.get('additional_context'):\n                summary.append(f\"Contexto adicional: {educational_context.get('additional_context')}\")\n            summary.append(\"\")\n        \n        # Transcription summary\n        if transcription:\n            summary.append(\"=== ANÁLISIS DE TRANSCRIPCIÓN ===\")\n            summary.append(f\"Texto: {transcription.get('text', 'N/A')[:500]}...\")\n            summary.append(f\"Velocidad de habla: {transcription.get('wpm', 0)} palabras por minuto\")\n            summary.append(f\"Total de pausas: {transcription.get('pauses', {}).get('count', 0)}\")\n            summary.append(f\"Duración promedio de pausas: {transcription.get('pauses', {}).get('avg_ms', 0)}ms\")\n            \n            fillers = transcription.get('fillers', {})\n            if fillers:\n                summary.append(f\"Muletillas detectadas: {dict(list(fillers.items())[:5])}\")\n        \n        # Prosodic summary\n        if prosody:\n            summary.append(\"\\n=== ANÁLISIS PROSÓDICO ===\")\n            summary.append(f\"Tono promedio: {prosody.get('f0_mean_hz', 0):.1f} Hz\")\n            summary.append(f\"Rango de tono: {prosody.get('f0_range_hz', 0):.1f} Hz\")\n            summary.append(f\"Variabilidad del tono (Jitter): {prosody.get('jitter_local', 0):.2f}%\")\n            summary.append(f\"Estabilidad del volumen (Shimmer): {prosody.get('shimmer_local', 0):.2f}%\")\n            summary.append(f\"Volumen promedio: {prosody.get('intensity_mean_db', 0):.1f} dB\")\n            summary.append(f\"Rango de volumen: {prosody.get('intensity_range_db', 0):.1f} dB\")\n        \n        return \"\\n\".join(summary)\n    \n    def _get_system_prompt(self):\n        \"\"\"Get the system prompt for RIC educational feedback\"\"\"\n        return \"\"\"\nEres RIC (Reflective Instruction Coach), un consultor educativo experto especializado en analizar la entrega de enseñanza y proporcionar retroalimentación práctica a educadores. Tu rol es ayudar a los maestros a mejorar la efectividad de su comunicación en el aula.\n\nÁREAS DE ANÁLISIS:\n1. Entrega del Discurso y Claridad\n2. Engagement y Ritmo\n3. Comunicación Profesional\n4. Manejo del Aula (señales verbales)\n5. Adecuación al Nivel Educativo\n\nCRITERIOS DE EVALUACIÓN:\n- Velocidad de Habla: Rango óptimo 120-160 PPM para instrucción\n- Uso de Pausas: Uso efectivo para énfasis y comprensión\n- Variedad Vocal: Rango de tono y patrones de entonación\n- Claridad: Mínimas muletillas y articulación clara\n- Control de Volumen: Intensidad y consistencia apropiadas\n- Adecuación al Grado: Lenguaje y conceptos apropiados para la edad\n\nADECUACIÓN POR NIVEL EDUCATIVO:\n- Primaria temprana (1°-3°): Lenguaje simple, analogías concretas, repetición frecuente\n- Primaria tardía (4°-6°): Vocabulario intermedio, ejemplos prácticos, explicaciones paso a paso\n- Secundaria (7°-9°): Conceptos más abstractos, terminología técnica moderada\n- Preparatoria (10°-12°): Lenguaje académico, conceptos complejos, análisis crítico\n\nRECOMENDACIONES ESPECÍFICAS POR NIVEL:\n- Si el contenido es muy técnico para el grado: \"En [momento específico] el lenguaje fue muy técnico. Considera usar analogías como [ejemplo] para que los estudiantes de este grado puedan entender mejor.\"\n- Si es muy simple para el grado: \"El nivel de explicación podría ser más desafiante para estudiantes de este grado.\"\n- Si las pausas son inadecuadas: \"Para estudiantes de este nivel, considera pausas más [largas/cortas] para permitir mejor procesamiento.\"\n\nFORMATO DE SALIDA (JSON):\n{\n  \"overall_score\": 1-100,\n  \"summary\": \"Evaluación general breve en español\",\n  \"strengths\": [\"Lista de 2-3 fortalezas clave\"],\n  \"areas_for_improvement\": [\"Lista de 2-3 áreas específicas de mejora\"],\n  \"detailed_analysis\": {\n    \"speech_delivery\": {\n      \"score\": 1-100,\n      \"feedback\": \"Retroalimentación específica sobre velocidad, claridad, articulación\",\n      \"recommendations\": [\"Sugerencias prácticas\"]\n    },\n    \"engagement_pace\": {\n      \"score\": 1-100,\n      \"feedback\": \"Análisis del ritmo e indicadores de engagement estudiantil\",\n      \"recommendations\": [\"Sugerencias prácticas\"]\n    },\n    \"vocal_variety\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de variación de tono y entonación\",\n      \"recommendations\": [\"Sugerencias prácticas\"]\n    },\n    \"professional_communication\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de muletillas, pausas, confianza\",\n      \"recommendations\": [\"Sugerencias prácticas\"]\n    },\n    \"grade_level_appropriateness\": {\n      \"score\": 1-100,\n      \"feedback\": \"Evaluación de la adecuación del lenguaje y conceptos al grado\",\n      \"recommendations\": [\"Sugerencias específicas para el nivel educativo\"]\n    }\n  },\n  \"key_metrics\": {\n    \"speech_rate_assessment\": \"muy_lento|lento|optimal|rapido|muy_rapido\",\n    \"pause_effectiveness\": \"poor|fair|good|excellent\",\n    \"filler_word_frequency\": \"high|moderate|low\",\n    \"vocal_confidence\": \"low|moderate|high\",\n    \"grade_appropriateness\": \"muy_simple|simple|adecuado|complejo|muy_complejo\"\n  },\n  \"action_plan\": [\"3-5 elementos de acción priorizados y específicos para mejora\"],\n  \"grade_specific_tips\": [\"2-3 consejos específicos para enseñar a este grado\"]\n}\n\nTONO: Profesional, apoyo, constructivo. Enfócate en el crecimiento y mejoras prácticas. Reconoce fortalezas mientras proporcionas orientación clara y práctica para la mejora.\n\nIMPORTANTE: \n- Todas las respuestas deben ser en español\n- Considera siempre el contexto educativo proporcionado (materia, grado, tema)\n- Da ejemplos específicos de la transcripción cuando hagas recomendaciones\n- Si detectas lenguaje muy técnico para el grado, sugiere analogías o simplificaciones específicas\n- Si el nivel es muy simple para el grado, sugiere cómo elevar el nivel académico apropiadamente\n\"\"\"\n    \n    def _get_error_feedback(self, error_message):\n        \"\"\"Return error feedback structure\"\"\"\n        return {\n            \"overall_score\": 0,\n            \"summary\": \"Analysis could not be completed due to technical error.\",\n            \"strengths\": [],\n            \"areas_for_improvement\": [\"Technical issue prevented analysis\"],\n            \"detailed_analysis\": {\n                \"speech_delivery\": {\"score\": 0, \"feedback\": \"Error occurred\", \"recommendations\": []},\n                \"engagement_pace\": {\"score\": 0, \"feedback\": \"Error occurred\", \"recommendations\": []},\n                \"vocal_variety\": {\"score\": 0, \"feedback\": \"Error occurred\", \"recommendations\": []},\n                \"professional_communication\": {\"score\": 0, \"feedback\": \"Error occurred\", \"recommendations\": []}\n            },\n            \"key_metrics\": {\n                \"speech_rate_assessment\": \"unknown\",\n                \"pause_effectiveness\": \"unknown\",\n                \"filler_word_frequency\": \"unknown\",\n                \"vocal_confidence\": \"unknown\"\n            },\n            \"action_plan\": [\"Please try uploading the audio file again\"],\n            \"error\": error_message,\n            \"ric_version\": \"1.0\"\n        }\n","size_bytes":10007},"routes.py":{"content":"import os\nimport logging\nfrom datetime import datetime\nfrom flask import render_template, request, jsonify, flash, redirect, url_for, send_file\nfrom werkzeug.utils import secure_filename\nfrom app import app, db\nfrom models import ClassroomAnalysis, AudioAnalysis  # AudioAnalysis is alias for backward compatibility\nfrom audio_processor import AudioProcessor\nfrom ric_agent import RICAgent\nfrom pdf_processor import PDFProcessor\nfrom lesson_plan_agent import LessonPlanAgent\nimport json\n\nAUDIO_EXTENSIONS = {'mp3', 'wav', 'm4a', 'ogg', 'flac'}\nPDF_EXTENSIONS = {'pdf'}\nALLOWED_EXTENSIONS = AUDIO_EXTENSIONS | PDF_EXTENSIONS\n\ndef allowed_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\ndef is_audio_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in AUDIO_EXTENSIONS\n\ndef is_pdf_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in PDF_EXTENSIONS\n\n@app.route('/')\ndef index():\n    \"\"\"Main page with analysis type selection\"\"\"\n    return render_template('index.html')\n\n@app.route('/upload-choice')\ndef upload_choice():\n    \"\"\"Page to choose between audio and PDF analysis\"\"\"\n    return render_template('upload_choice.html')\n\n@app.route('/upload-audio')\ndef upload_audio_page():\n    \"\"\"Audio upload page\"\"\"\n    recent_analyses = ClassroomAnalysis.query.filter_by(analysis_type='audio').order_by(ClassroomAnalysis.upload_timestamp.desc()).limit(5).all()\n    return render_template('audio_upload.html', recent_analyses=recent_analyses)\n\n@app.route('/upload-pdf')\ndef upload_pdf_page():\n    \"\"\"PDF upload page\"\"\"\n    recent_analyses = ClassroomAnalysis.query.filter_by(analysis_type='pdf').order_by(ClassroomAnalysis.upload_timestamp.desc()).limit(5).all()\n    return render_template('pdf_upload.html', recent_analyses=recent_analyses)\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    \"\"\"Handle both audio and PDF file uploads with educational context\"\"\"\n    try:\n        # Check for either audio or PDF file\n        file = None\n        analysis_type = None\n        \n        if 'audio_file' in request.files and request.files['audio_file'].filename:\n            file = request.files['audio_file']\n            analysis_type = 'audio'\n        elif 'pdf_file' in request.files and request.files['pdf_file'].filename:\n            file = request.files['pdf_file']\n            analysis_type = 'pdf'\n        \n        if not file or not analysis_type:\n            flash('No file selected', 'error')\n            return redirect(url_for('index'))\n        if file.filename == '':\n            flash('No file selected', 'error')\n            return redirect(url_for('index'))\n        \n        if file.filename is None or not allowed_file(file.filename):\n            if analysis_type == 'audio':\n                flash('Invalid file format. Please upload MP3, WAV, M4A, OGG, or FLAC files.', 'error')\n            else:\n                flash('Invalid file format. Please upload PDF files.', 'error')\n            return redirect(url_for('index'))\n        \n        # Save the file\n        if file.filename is None:\n            flash('Invalid filename', 'error')\n            return redirect(url_for('index'))\n        \n        filename = secure_filename(file.filename)\n        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\n        filename = f\"{timestamp}_{filename}\"\n        filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)\n        file.save(filepath)\n        \n        # Get educational context from form\n        subject = request.form.get('subject', '').strip()\n        grade_level = request.form.get('grade_level', '').strip()\n        lesson_topic = request.form.get('lesson_topic', '').strip()\n        additional_context = request.form.get('additional_context', '').strip()\n        \n        # Create database record\n        analysis = ClassroomAnalysis()\n        analysis.filename = filename\n        analysis.original_filename = file.filename\n        analysis.analysis_type = analysis_type\n        analysis.subject = subject\n        analysis.grade_level = grade_level\n        analysis.lesson_topic = lesson_topic\n        analysis.additional_context = additional_context\n        analysis.status = 'uploaded'\n        \n        # Add PDF-specific context if applicable\n        if analysis_type == 'pdf':\n            lesson_duration = request.form.get('lesson_duration', '').strip()\n            student_count = request.form.get('student_count', '').strip()\n            learning_objectives = request.form.get('learning_objectives', '').strip()\n            \n            analysis.lesson_duration = int(lesson_duration) if lesson_duration.isdigit() else None\n            analysis.student_count = int(student_count) if student_count.isdigit() else None\n            analysis.learning_objectives = learning_objectives\n        \n        db.session.add(analysis)\n        db.session.commit()\n        \n        if analysis_type == 'audio':\n            flash('Audio uploaded successfully! Speech analysis is starting...', 'success')\n        else:\n            flash('PDF uploaded successfully! Lesson plan analysis is starting...', 'success')\n        \n        return redirect(url_for('analyze', analysis_id=analysis.id))\n        \n    except Exception as e:\n        logging.error(f\"Upload error: {str(e)}\")\n        flash('Error uploading file. Please try again.', 'error')\n        return redirect(url_for('index'))\n\n@app.route('/analyze/<int:analysis_id>')\ndef analyze(analysis_id):\n    \"\"\"Display analysis page and trigger processing for both audio and PDF\"\"\"\n    analysis = ClassroomAnalysis.query.get_or_404(analysis_id)\n    \n    # If not yet processed, start appropriate processing\n    if analysis.status == 'uploaded':\n        try:\n            if analysis.is_audio_analysis():\n                process_audio_analysis(analysis)\n            elif analysis.is_pdf_analysis():\n                process_pdf_analysis(analysis)\n        except Exception as e:\n            logging.error(f\"Analysis error: {str(e)}\")\n            analysis.status = 'error'\n            analysis.error_message = str(e)\n            db.session.commit()\n    \n    # Use appropriate template based on analysis type\n    if analysis.is_pdf_analysis():\n        return render_template('lesson_analysis.html', analysis=analysis)\n    else:\n        return render_template('analysis.html', analysis=analysis)\n\n@app.route('/api/analysis/<int:analysis_id>/status')\ndef get_analysis_status(analysis_id):\n    \"\"\"Get current analysis status via API\"\"\"\n    analysis = ClassroomAnalysis.query.get_or_404(analysis_id)\n    return jsonify({\n        'status': analysis.status,\n        'error_message': analysis.error_message,\n        'analysis_type': analysis.analysis_type\n    })\n\n@app.route('/api/analysis/<int:analysis_id>/results')\ndef get_analysis_results(analysis_id):\n    \"\"\"Get analysis results via API for both audio and PDF\"\"\"\n    analysis = ClassroomAnalysis.query.get_or_404(analysis_id)\n    \n    if analysis.status != 'completed':\n        return jsonify({'error': 'Analysis not completed'}), 400\n    \n    results = {\n        'analysis_type': analysis.analysis_type,\n        'feedback': analysis.get_ric_feedback()\n    }\n    \n    if analysis.is_audio_analysis():\n        results.update({\n            'transcription': analysis.get_transcription_data(),\n            'prosody': analysis.get_prosody_data()\n        })\n    elif analysis.is_pdf_analysis():\n        results.update({\n            'lesson_structure': analysis.get_lesson_plan_structure(),\n            'pedagogical_analysis': analysis.get_pedagogical_analysis()\n        })\n    \n    return jsonify(results)\n\n@app.route('/history')\ndef history():\n    \"\"\"View analysis history for both audio and PDF\"\"\"\n    analyses = ClassroomAnalysis.query.order_by(ClassroomAnalysis.upload_timestamp.desc()).all()\n    return render_template('history.html', analyses=analyses)\n\n@app.route('/dashboard')\ndef dashboard():\n    \"\"\"Show progress dashboard with analytics\"\"\"\n    return render_template('dashboard.html')\n\n@app.route('/api/progress')\ndef get_progress_data():\n    \"\"\"Get comprehensive progress analytics\"\"\"\n    try:\n        # Basic counts\n        total_analyses = ClassroomAnalysis.query.count()\n        audio_analyses = ClassroomAnalysis.query.filter_by(analysis_type='audio').count()\n        pdf_analyses = ClassroomAnalysis.query.filter_by(analysis_type='pdf').count()\n        \n        # Status distribution\n        completed_analyses = ClassroomAnalysis.query.filter_by(status='completed').count()\n        processing_analyses = ClassroomAnalysis.query.filter_by(status='processing').count()\n        error_analyses = ClassroomAnalysis.query.filter_by(status='error').count()\n        uploaded_analyses = ClassroomAnalysis.query.filter_by(status='uploaded').count()\n        \n        # Subject distribution (top 10)\n        subject_stats = db.session.query(\n            ClassroomAnalysis.subject, \n            db.func.count(ClassroomAnalysis.id).label('count')\n        ).filter(\n            ClassroomAnalysis.subject.isnot(None)\n        ).group_by(ClassroomAnalysis.subject).order_by(\n            db.func.count(ClassroomAnalysis.id).desc()\n        ).limit(10).all()\n        \n        # Grade level distribution\n        grade_stats = db.session.query(\n            ClassroomAnalysis.grade_level, \n            db.func.count(ClassroomAnalysis.id).label('count')\n        ).filter(\n            ClassroomAnalysis.grade_level.isnot(None)\n        ).group_by(ClassroomAnalysis.grade_level).order_by(\n            db.func.count(ClassroomAnalysis.id).desc()\n        ).limit(10).all()\n        \n        # Recent activity (last 7 days)\n        from datetime import datetime, timedelta\n        week_ago = datetime.utcnow() - timedelta(days=7)\n        recent_activity = db.session.query(\n            db.func.date(ClassroomAnalysis.upload_timestamp).label('date'),\n            db.func.count(ClassroomAnalysis.id).label('count')\n        ).filter(\n            ClassroomAnalysis.upload_timestamp >= week_ago\n        ).group_by(\n            db.func.date(ClassroomAnalysis.upload_timestamp)\n        ).order_by(\n            db.func.date(ClassroomAnalysis.upload_timestamp)\n        ).all()\n        \n        # Success rate calculation\n        success_rate = (completed_analyses / total_analyses * 100) if total_analyses > 0 else 0\n        \n        # Average processing time for completed analyses\n        completed_with_times = ClassroomAnalysis.query.filter(\n            ClassroomAnalysis.status == 'completed',\n            ClassroomAnalysis.analysis_timestamp.isnot(None)\n        ).all()\n        \n        processing_times = []\n        for analysis in completed_with_times:\n            if analysis.analysis_timestamp and analysis.upload_timestamp:\n                diff = analysis.analysis_timestamp - analysis.upload_timestamp\n                processing_times.append(diff.total_seconds())\n        \n        avg_processing_time = sum(processing_times) / len(processing_times) if processing_times else 0\n        \n        # Most active time periods\n        hour_stats = db.session.query(\n            db.func.extract('hour', ClassroomAnalysis.upload_timestamp).label('hour'),\n            db.func.count(ClassroomAnalysis.id).label('count')\n        ).group_by(\n            db.func.extract('hour', ClassroomAnalysis.upload_timestamp)\n        ).order_by(\n            db.func.count(ClassroomAnalysis.id).desc()\n        ).limit(5).all()\n        \n        # Recent analyses with details\n        recent_analyses = ClassroomAnalysis.query.order_by(\n            ClassroomAnalysis.upload_timestamp.desc()\n        ).limit(10).all()\n        \n        recent_list = []\n        for analysis in recent_analyses:\n            recent_list.append({\n                'id': analysis.id,\n                'filename': analysis.original_filename,\n                'type': analysis.analysis_type,\n                'subject': analysis.subject or 'General',\n                'grade': analysis.grade_level or 'No especificado',\n                'status': analysis.status,\n                'upload_time': analysis.upload_timestamp.strftime('%Y-%m-%d %H:%M'),\n                'processing_time': analysis.analysis_timestamp.strftime('%Y-%m-%d %H:%M') if analysis.analysis_timestamp else None\n            })\n        \n        return jsonify({\n            'total_stats': {\n                'total_analyses': total_analyses,\n                'audio_analyses': audio_analyses,\n                'pdf_analyses': pdf_analyses,\n                'completed_analyses': completed_analyses,\n                'processing_analyses': processing_analyses,\n                'error_analyses': error_analyses,\n                'uploaded_analyses': uploaded_analyses,\n                'success_rate': round(success_rate, 1),\n                'avg_processing_time': round(avg_processing_time, 1)\n            },\n            'distributions': {\n                'subjects': [{'name': s.subject or 'Sin especificar', 'count': s.count} for s in subject_stats],\n                'grades': [{'name': g.grade_level or 'Sin especificar', 'count': g.count} for g in grade_stats],\n                'status': [\n                    {'name': 'Completados', 'count': completed_analyses, 'color': '#10b981'},\n                    {'name': 'Procesando', 'count': processing_analyses, 'color': '#f59e0b'},\n                    {'name': 'Error', 'count': error_analyses, 'color': '#ef4444'},\n                    {'name': 'Pendientes', 'count': uploaded_analyses, 'color': '#6b7280'}\n                ]\n            },\n            'activity_trends': {\n                'recent_activity': [{'date': str(r.date), 'count': r.count} for r in recent_activity],\n                'hourly_activity': [{'hour': int(h.hour), 'count': h.count} for h in hour_stats]\n            },\n            'recent_analyses': recent_list\n        })\n        \n    except Exception as e:\n        logging.error(f\"Error getting progress data: {str(e)}\")\n        return jsonify({'error': 'Error al obtener datos de progreso'}), 500\n\ndef process_audio_analysis(analysis):\n    \"\"\"Process audio file and generate analysis\"\"\"\n    try:\n        analysis.status = 'processing'\n        db.session.commit()\n        \n        filepath = os.path.join(app.config['UPLOAD_FOLDER'], analysis.filename)\n        \n        # Initialize processors\n        audio_processor = AudioProcessor()\n        ric_agent = RICAgent()\n        \n        logging.info(f\"Starting transcription for {analysis.filename}\")\n        \n        # Step 1: Transcribe audio\n        transcription_result = audio_processor.transcribe_audio(filepath)\n        analysis.transcription_text = transcription_result['text']\n        analysis.set_transcription_data(transcription_result)\n        db.session.commit()\n        \n        logging.info(f\"Starting prosodic analysis for {analysis.filename}\")\n        \n        # Step 2: Analyze prosody\n        prosody_result = audio_processor.analyze_prosody(filepath)\n        analysis.set_prosody_data(prosody_result)\n        db.session.commit()\n        \n        logging.info(f\"Starting RIC feedback generation for {analysis.filename}\")\n        \n        # Step 3: Generate RIC feedback with educational context\n        educational_context = analysis.get_educational_context()\n        combined_data = {\n            'transcription': transcription_result,\n            'prosody': prosody_result,\n            'educational_context': educational_context\n        }\n        \n        feedback = ric_agent.generate_educational_feedback(combined_data)\n        analysis.set_ric_feedback(feedback)\n        \n        # Mark as completed\n        analysis.status = 'completed'\n        analysis.analysis_timestamp = datetime.utcnow()\n        db.session.commit()\n        \n        logging.info(f\"Analysis completed for {analysis.filename}\")\n        \n    except Exception as e:\n        logging.error(f\"Processing error for {analysis.filename}: {str(e)}\")\n        analysis.status = 'error'\n        analysis.error_message = str(e)\n        db.session.commit()\n        raise e\n\ndef process_pdf_analysis(analysis):\n    \"\"\"Process PDF file and generate pedagogical analysis\"\"\"\n    try:\n        analysis.status = 'processing'\n        db.session.commit()\n        \n        filepath = os.path.join(app.config['UPLOAD_FOLDER'], analysis.filename)\n        \n        # Initialize processors\n        pdf_processor = PDFProcessor()\n        lesson_plan_agent = LessonPlanAgent()\n        \n        logging.info(f\"Starting PDF text extraction for {analysis.filename}\")\n        \n        # Step 1: Extract text from PDF\n        pdf_text = pdf_processor.extract_text_from_pdf(filepath)\n        analysis.pdf_text_content = pdf_text[:10000]  # Store first 10K characters\n        db.session.commit()\n        \n        logging.info(f\"Starting lesson plan structure analysis for {analysis.filename}\")\n        \n        # Step 2: Analyze lesson plan structure\n        structure_analysis = pdf_processor.analyze_lesson_plan_structure(pdf_text)\n        analysis.set_lesson_plan_structure(structure_analysis)\n        db.session.commit()\n        \n        logging.info(f\"Starting pedagogical feedback generation for {analysis.filename}\")\n        \n        # Step 3: Generate pedagogical feedback with educational context\n        educational_context = analysis.get_educational_context()\n        pdf_summary = pdf_processor.get_analysis_summary(structure_analysis)\n        \n        combined_data = {\n            'structure_analysis': structure_analysis,\n            'educational_context': educational_context,\n            'pdf_summary': pdf_summary,\n            'timestamp': datetime.utcnow().isoformat()\n        }\n        \n        feedback = lesson_plan_agent.generate_pedagogical_feedback(combined_data)\n        analysis.set_ric_feedback(feedback)\n        \n        # Mark as completed\n        analysis.status = 'completed'\n        analysis.analysis_timestamp = datetime.utcnow()\n        db.session.commit()\n        \n        logging.info(f\"PDF analysis completed for {analysis.filename}\")\n        \n    except Exception as e:\n        logging.error(f\"PDF processing error for {analysis.filename}: {str(e)}\")\n        analysis.status = 'error'\n        analysis.error_message = str(e)\n        db.session.commit()\n        raise e\n","size_bytes":18205},"static/css/style.css":{"content":"/* RIC - Reflective Instruction Coach Styles */\n\n:root {\n    /* Nueva paleta de colores */\n    --color-primary: #9da0e5;    /* Púrpura claro principal */\n    --color-primary-dark: #424453;\n    --color-primary-light: #fbceb1;\n\n    /* Éxito / progreso */\n    --color-success: #9da0e5;    /* Púrpura para progreso */\n    --color-success-light: #fbceb1;\n\n    /* Advertencia / mejoras sugeridas */\n    --color-warning: #fbceb1;    /* Melocotón suave */\n    --color-warning-light: #fbceb1;\n\n    /* Error / crítica */\n    --color-danger: #f6b5b7;     /* Rosa suave para errores */\n    --color-danger-light: #f6b5b7;\n\n    /* Insights / creatividad */\n    --color-insight: #9da0e5;    /* Púrpura para análisis */\n    --color-insight-light: #fbceb1;\n\n    /* Neutros y fondos */\n    --color-bg: #2f313e;        /* Fondo principal oscuro */\n    --color-bg-alt: #424453;    /* Fondo alternativo */\n    --color-surface: #424453;   /* Superficie de tarjetas */\n    --color-text: #ffffff;      /* Texto principal blanco */\n    --color-text-secondary: #ffffff;  /* Texto secundario blanco */\n    --color-border: #424453;    /* Bordes */\n\n    /* Botones CTA */\n    --color-cta: #9da0e5;       /* Púrpura para botones */\n    --color-cta-hover: #424453;\n    \n    /* Legacy compatibility (mapped to new colors) */\n    --primary-color: var(--color-primary);\n    --success-color: var(--color-success);\n    --warning-color: var(--color-warning);\n    --danger-color: var(--color-danger);\n    --accent-color: var(--color-insight);\n    --light-gray: var(--color-bg-alt);\n    --medium-gray: var(--color-border);\n    --text-primary: var(--color-text);\n    --text-secondary: var(--color-text-secondary);\n    --text-soft: #fbceb1;\n    \n    /* Design tokens */\n    --border-radius: 12px;\n    --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);\n}\n\n/* Base Styles */\nbody {\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n    color: var(--color-text);\n    background: linear-gradient(135deg, #2f313e 0%, #424453 50%, #2f313e 100%);\n    min-height: 100vh;\n    line-height: 1.6;\n}\n\n/* Text Colors */\n.text-soft {\n    color: var(--text-soft) !important;\n}\n\n.text-secondary {\n    color: var(--color-text-secondary) !important;\n}\n\nh1, h2, h3, h4, h5, h6 {\n    color: var(--color-text);\n}\n\n.card-title {\n    color: var(--color-text);\n    font-weight: 600;\n}\n\n.lesson-topic {\n    color: var(--color-primary);\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n}\n\n.container {\n    max-width: 1200px;\n}\n\n/* Navigation */\n.navbar-brand {\n    font-size: 1.5rem;\n}\n\n.navbar-dark {\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark)) !important;\n    box-shadow: 0 4px 20px rgba(30, 136, 229, 0.3);\n}\n\n/* Cards */\n.card {\n    border: none;\n    border-radius: var(--border-radius);\n    box-shadow: 0 8px 32px rgba(47, 49, 62, 0.12);\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n    background: rgba(66, 68, 83, 0.95);\n    backdrop-filter: blur(10px);\n}\n\n.card-body {\n    background: rgba(66, 68, 83, 0.98);\n    border-radius: 0 0 var(--border-radius) var(--border-radius);\n}\n\n.card-header {\n    background: rgba(66, 68, 83, 0.95) !important;\n    border-bottom: 1px solid rgba(157, 160, 229, 0.1);\n    border-radius: var(--border-radius) var(--border-radius) 0 0;\n}\n\n.card-header .card-title,\n.card-header h6 {\n    color: var(--color-text) !important;\n    font-weight: 600;\n}\n\n.card:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 16px 40px rgba(157, 160, 229, 0.2), 0 8px 16px rgba(0, 0, 0, 0.1);\n}\n\n/* Upload Area */\n.upload-area {\n    border: 2px dashed rgba(157, 160, 229, 0.3);\n    border-radius: var(--border-radius);\n    padding: 3rem 2rem;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    background: linear-gradient(135deg, rgba(157, 160, 229, 0.08) 0%, rgba(251, 206, 177, 0.05) 100%);\n}\n\n.upload-area:hover {\n    border-color: var(--color-primary);\n    background: linear-gradient(135deg, rgba(157, 160, 229, 0.05) 0%, rgba(157, 160, 229, 0.02) 100%);\n    transform: translateY(-2px);\n    box-shadow: 0 8px 25px rgba(157, 160, 229, 0.1);\n}\n\n.upload-area.dragover {\n    border-color: var(--color-primary);\n    background: linear-gradient(135deg, rgba(157, 160, 229, 0.1) 0%, rgba(157, 160, 229, 0.05) 100%);\n}\n\n.upload-icon {\n    width: 48px;\n    height: 48px;\n    color: var(--color-text-secondary);\n    margin-bottom: 1rem;\n}\n\n.upload-content h6 {\n    color: var(--color-text);\n    margin-bottom: 0.5rem;\n    font-weight: 600;\n}\n\n/* Feature Badges */\n.feature-badge {\n    display: inline-flex;\n    align-items: center;\n    padding: 0.5rem 1rem;\n    background: linear-gradient(135deg, rgba(157, 160, 229, 0.15) 0%, rgba(251, 206, 177, 0.1) 100%);\n    color: var(--color-primary);\n    border-radius: 20px;\n    font-size: 0.875rem;\n    font-weight: 500;\n    border: 1px solid rgba(157, 160, 229, 0.3);\n    transition: all 0.3s ease;\n    box-shadow: 0 2px 8px rgba(157, 160, 229, 0.15);\n}\n\n.feature-badge:hover {\n    background: rgba(157, 160, 229, 0.2);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px rgba(157, 160, 229, 0.2);\n}\n\n/* Feature Icons */\n.feature-icon {\n    width: 80px;\n    height: 80px;\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 0 auto;\n    box-shadow: var(--box-shadow);\n}\n\n.feature-icon i {\n    width: 32px;\n    height: 32px;\n    color: white;\n}\n\n/* Status Badges */\n.status-badge {\n    font-size: 0.9rem;\n}\n\n/* Progress Steps */\n.progress-steps {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 2rem;\n    margin-top: 2rem;\n}\n\n.step {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    opacity: 0.4;\n    transition: opacity 0.3s ease;\n}\n\n.step.completed,\n.step.processing {\n    opacity: 1;\n}\n\n.step.processing i {\n    animation: pulse 2s infinite;\n}\n\n.step i {\n    width: 32px;\n    height: 32px;\n    padding: 8px;\n    background: var(--color-primary);\n    color: white;\n    border-radius: 50%;\n}\n\n.step span {\n    font-size: 0.875rem;\n    font-weight: 500;\n}\n\n/* Metric Cards */\n.metric-card {\n    background: var(--color-bg);\n    border-radius: var(--border-radius);\n    padding: 1.5rem;\n    text-align: center;\n    box-shadow: var(--box-shadow);\n    transition: transform 0.2s ease;\n}\n\n.metric-card:hover {\n    transform: translateY(-2px);\n}\n\n.metric-icon {\n    width: 48px;\n    height: 48px;\n    background: var(--color-surface);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 0 auto 1rem;\n}\n\n.metric-icon i {\n    color: var(--color-primary);\n}\n\n.metric-value {\n    font-size: 2rem;\n    font-weight: bold;\n    color: var(--color-text);\n    margin-bottom: 0.25rem;\n}\n\n.metric-label {\n    font-size: 0.875rem;\n    color: var(--color-text-secondary);\n    margin-bottom: 0.5rem;\n}\n\n.metric-status {\n    padding: 0.25rem 0.75rem;\n    border-radius: 12px;\n    font-size: 0.75rem;\n    font-weight: 600;\n    text-transform: capitalize;\n}\n\n.status-excellent {\n    background: var(--color-success-light);\n    color: var(--color-success);\n}\n\n.status-good {\n    background: rgba(102, 187, 106, 0.2);\n    color: var(--color-success);\n}\n\n.status-optimal {\n    background: var(--color-success-light);\n    color: var(--color-success);\n}\n\n.status-fair {\n    background: var(--color-warning-light);\n    color: var(--color-warning);\n}\n\n.status-poor {\n    background: var(--color-danger-light);\n    color: var(--color-danger);\n}\n\n.status-slow {\n    background: var(--color-warning-light);\n    color: var(--color-warning);\n}\n\n.status-fast {\n    background: var(--color-danger-light);\n    color: var(--color-danger);\n}\n\n/* Score Circle */\n.score-circle {\n    position: relative;\n    display: inline-block;\n}\n\n.score-text {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    text-align: center;\n}\n\n.score-number {\n    display: block;\n    font-size: 2rem;\n    font-weight: bold;\n    color: var(--color-text) !important;\n}\n\n.score-total {\n    color: var(--color-text-secondary) !important;\n    font-size: 1rem;\n}\n\n.score-label {\n    font-size: 0.875rem;\n    opacity: 0.8;\n    color: var(--color-text-secondary) !important;\n}\n\n/* Progress Bars */\n.progress {\n    height: 8px;\n    background-color: var(--color-surface);\n    border-radius: 4px;\n}\n\n.progress-bar {\n    background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark));\n    border-radius: 4px;\n}\n\n/* Transcription */\n.transcription-text {\n    background: var(--color-surface);\n    padding: 1.5rem;\n    border-radius: var(--border-radius);\n    line-height: 1.8;\n    font-size: 1.1rem;\n    max-height: 400px;\n    overflow-y: auto;\n}\n\n/* Recommendations */\n.recommendations ul {\n    list-style-type: none;\n    padding-left: 0;\n}\n\n.recommendations li {\n    padding-left: 1.5rem;\n    position: relative;\n    margin-bottom: 0.5rem;\n}\n\n.recommendations li:before {\n    content: \"→\";\n    position: absolute;\n    left: 0;\n    color: var(--color-primary);\n    font-weight: bold;\n}\n\n/* Gradients */\n.bg-gradient-primary {\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));\n}\n\n/* Animations */\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.5; }\n}\n\n.spinner-border {\n    width: 2rem;\n    height: 2rem;\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    .progress-steps {\n        flex-direction: column;\n        gap: 1rem;\n    }\n    \n    .metric-card {\n        margin-bottom: 1rem;\n    }\n    \n    .score-text .score-number {\n        font-size: 1.5rem;\n    }\n    \n    .upload-area {\n        padding: 2rem 1rem;\n    }\n}\n\n/* Dark mode support - Override with our custom palette */\n@media (prefers-color-scheme: dark) {\n    body {\n        background-color: #2f313e !important;\n        color: #f6b5b7 !important;\n    }\n    \n    .card {\n        background-color: #424453 !important;\n        color: #f6b5b7 !important;\n    }\n    \n    .upload-area {\n        background-color: #424453 !important;\n        border-color: #9da0e5 !important;\n    }\n    \n    .transcription-text {\n        background-color: #424453 !important;\n        color: #f6b5b7 !important;\n    }\n}\n\n/* Print Styles */\n@media print {\n    .navbar,\n    .btn,\n    .progress-steps,\n    .upload-area {\n        display: none !important;\n    }\n    \n    .card {\n        box-shadow: none;\n        border: 1px solid #ddd;\n    }\n    \n    body {\n        background: white;\n        color: black;\n    }\n}\n\n/* Educational Context Styling */\n.educational-context {\n    background: linear-gradient(135deg, rgba(157, 160, 229, 0.15) 0%, rgba(251, 206, 177, 0.08) 100%);\n    border-radius: var(--border-radius);\n    padding: 1.5rem;\n    border: 1px solid rgba(157, 160, 229, 0.2);\n    box-shadow: 0 4px 20px rgba(157, 160, 229, 0.1);\n}\n\n.lesson-planning-context {\n    background: linear-gradient(135deg, rgba(251, 206, 177, 0.12) 0%, rgba(157, 160, 229, 0.06) 100%);\n    border-radius: var(--border-radius);\n    padding: 1.5rem;\n    border: 1px solid rgba(251, 206, 177, 0.2);\n    box-shadow: 0 4px 20px rgba(251, 206, 177, 0.08);\n}\n\n.lesson-planning-context .form-label {\n    color: var(--color-text) !important;\n    font-weight: 600;\n}\n\n.educational-context-summary {\n    margin-top: 0.5rem;\n}\n\n.educational-context-summary .badge {\n    font-size: 0.75rem;\n    padding: 0.35rem 0.65rem;\n}\n\n.upload-section {\n    background: linear-gradient(135deg, rgba(66, 68, 83, 0.9) 0%, rgba(47, 49, 62, 0.9) 100%);\n    border-radius: var(--border-radius);\n    padding: 1rem;\n    border: 1px solid rgba(157, 160, 229, 0.1);\n    box-shadow: 0 2px 16px rgba(157, 160, 229, 0.08);\n}\n\n/* Educational Theme Colors */\n.bg-educational-primary {\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));\n}\n\n.bg-educational-secondary {\n    background: linear-gradient(135deg, var(--color-insight), var(--color-insight-light));\n}\n\n/* Grade-specific color coding */\n.grade-tips {\n    background: var(--color-insight-light);\n    padding: 1rem;\n    border-radius: 8px;\n    border-left: 4px solid var(--color-insight);\n}\n\n.grade-tips strong {\n    color: var(--color-insight);\n}\n\n/* Audio Recording Interface */\n.audio-options .btn-group {\n    box-shadow: var(--box-shadow);\n    border-radius: var(--border-radius);\n    overflow: hidden;\n}\n\n.recording-interface {\n    background: linear-gradient(135deg, var(--color-danger-light), rgba(246, 181, 183, 0.1));\n    border: 2px solid var(--color-danger);\n    border-radius: var(--border-radius);\n    transition: all 0.3s ease;\n}\n\n.recording-interface.recording {\n    animation: pulse-border 2s infinite;\n}\n\n.recording-icon {\n    position: relative;\n}\n\n.recording-pulse {\n    animation: pulse-mic 2s infinite ease-in-out;\n}\n\n@keyframes pulse-mic {\n    0%, 100% {\n        transform: scale(1);\n        opacity: 1;\n    }\n    50% {\n        transform: scale(1.1);\n        opacity: 0.8;\n    }\n}\n\n@keyframes pulse-border {\n    0%, 100% {\n        border-color: var(--color-danger);\n        box-shadow: 0 0 0 0 rgba(246, 181, 183, 0.7);\n    }\n    50% {\n        border-color: var(--color-danger);\n        box-shadow: 0 0 0 10px rgba(246, 181, 183, 0);\n    }\n}\n\n.recording-interface .btn {\n    margin: 0 0.25rem;\n    min-width: 100px;\n}\n\n/* Audio Controls */\n.recorded-audio-controls {\n    display: flex;\n    gap: 0.5rem;\n    align-items: center;\n}\n\n.audio-timer {\n    font-family: 'Courier New', monospace;\n    letter-spacing: 1px;\n}\n\n/* Microphone Button States */\n.btn-record {\n    background: linear-gradient(135deg, var(--color-danger), #C62828);\n    border: none;\n    color: white;\n    transition: all 0.3s ease;\n}\n\n.btn-record:hover {\n    background: linear-gradient(135deg, #C62828, #B71C1C);\n    transform: translateY(-2px);\n    box-shadow: 0 8px 15px rgba(229, 57, 53, 0.3);\n}\n\n.btn-record.recording {\n    animation: pulse 2s infinite;\n}\n\n/* Audio Preview */\n.audio-preview {\n    background: rgba(30, 136, 229, 0.05);\n    border: 1px solid rgba(30, 136, 229, 0.1);\n    border-radius: var(--border-radius);\n    padding: 1rem;\n}\n\n.audio-preview audio {\n    width: 100%;\n    margin-top: 0.5rem;\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n    .audio-options .btn-group {\n        flex-direction: column;\n    }\n    \n    .audio-options .btn {\n        border-radius: 0;\n        margin-bottom: -1px;\n    }\n    \n    .audio-options .btn:first-child {\n        border-radius: var(--border-radius) var(--border-radius) 0 0;\n    }\n    \n    .audio-options .btn:last-child {\n        border-radius: 0 0 var(--border-radius) var(--border-radius);\n        margin-bottom: 0;\n    }\n    \n    .recording-interface .btn {\n        margin: 0.25rem 0;\n        width: 100%;\n    }\n}\n\n/* Subject and Grade Badges */\n.subject-badge {\n    margin-bottom: 1rem;\n    font-weight: 500;\n    border-radius: 16px;\n    padding: 0.4rem 0.8rem;\n}\n\n.subject-matemáticas, .bg-subject-matemáticas {\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark)) !important;\n    color: white !important;\n}\n\n.subject-español, .subject-español___lenguaje, .bg-subject-español, .bg-subject-español___lenguaje {\n    background: linear-gradient(135deg, var(--color-danger), #C62828) !important;\n    color: white !important;\n}\n\n.subject-ciencias-naturales, .bg-subject-ciencias_naturales {\n    background: linear-gradient(135deg, var(--color-success), #1B5E20) !important;\n    color: white !important;\n}\n\n.subject-ciencias-sociales, .subject-ciencias-sociales___historia, .bg-subject-ciencias_sociales, .bg-subject-ciencias_sociales___historia {\n    background: linear-gradient(135deg, var(--color-cta), var(--color-cta-hover)) !important;\n    color: white !important;\n}\n\n.subject-inglés, .bg-subject-inglés {\n    background: linear-gradient(135deg, var(--color-insight), #5E35B1) !important;\n    color: white !important;\n}\n\n.subject-educación-física, .bg-subject-educación_física {\n    background: linear-gradient(135deg, #E91E63, #AD1457) !important;\n    color: white !important;\n}\n\n.subject-arte, .subject-arte___educación-artística, .bg-subject-arte, .bg-subject-arte___educación_artística {\n    background: linear-gradient(135deg, #9C27B0, #6A1B9A) !important;\n    color: white !important;\n}\n\n.subject-tecnología, .bg-subject-tecnología {\n    background: linear-gradient(135deg, var(--color-text-secondary), #37474F) !important;\n    color: white !important;\n}\n\n.subject-física, .bg-subject-física {\n    background: linear-gradient(135deg, #00BCD4, #0097A7) !important;\n    color: white !important;\n}\n\n.subject-química, .bg-subject-química {\n    background: linear-gradient(135deg, #FF5722, #D84315) !important;\n    color: white !important;\n}\n\n.subject-biología, .bg-subject-biología {\n    background: linear-gradient(135deg, #4CAF50, #2E7D32) !important;\n    color: white !important;\n}\n\n.subject-otro, .subject-otra-materia, .bg-subject-otro, .bg-subject-otra_materia {\n    background: linear-gradient(135deg, var(--color-text-secondary), #455A64) !important;\n    color: white !important;\n}\n\n.bg-grade {\n    background: rgba(30, 136, 229, 0.1) !important;\n    color: var(--color-primary) !important;\n    border: 1px solid rgba(30, 136, 229, 0.2);\n}\n\n/* Analysis Cards */\n.analysis-card, .analysis-type-card {\n    border: none;\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(245, 247, 250, 0.9) 100%);\n    transition: all 0.3s ease;\n    border-radius: var(--border-radius);\n    box-shadow: 0 8px 32px rgba(30, 136, 229, 0.12);\n    backdrop-filter: blur(10px);\n}\n\n.analysis-card:hover, .analysis-type-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.1);\n    border-color: var(--color-primary);\n}\n\n/* Analysis Main Icons */\n.analysis-main-icon {\n    width: 64px;\n    height: 64px;\n    stroke-width: 1.5;\n    color: var(--color-primary);\n}\n\n.feature-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 0.5rem;\n    font-size: 0.9rem;\n}\n\n.feature-item span {\n    color: var(--color-text-secondary);\n}\n\n.benefit-card {\n    padding: 2rem 1rem;\n}\n\n.benefit-icon {\n    width: 48px;\n    height: 48px;\n    stroke-width: 1.5;\n}\n\n/* Score Preview */\n.score-preview {\n    padding: 0.75rem;\n    background: linear-gradient(135deg, rgba(30, 136, 229, 0.05), rgba(30, 136, 229, 0.02));\n    border-radius: 8px;\n    border: 1px solid rgba(30, 136, 229, 0.1);\n}\n\n.score-text {\n    color: var(--color-text);\n    font-size: 0.875rem;\n}\n\n/* Status Badges */\n.status-badge-success {\n    background: linear-gradient(135deg, var(--color-success), #1B5E20) !important;\n    color: white !important;\n    border: none;\n}\n\n.status-badge-warning {\n    background: linear-gradient(135deg, var(--color-warning), #F9A825) !important;\n    color: var(--color-text) !important;\n    border: none;\n}\n\n.status-badge-danger {\n    background: linear-gradient(135deg, var(--color-danger), #C62828) !important;\n    color: white !important;\n    border: none;\n}\n\n/* Button Improvements */\n.btn {\n    font-weight: 500;\n    border-radius: var(--border-radius);\n    transition: all 0.3s ease;\n    border: none;\n}\n\n.btn-primary {\n    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));\n    box-shadow: 0 4px 12px rgba(30, 136, 229, 0.3);\n    color: white;\n}\n\n.btn-primary:hover {\n    background: linear-gradient(135deg, var(--color-primary-dark), #0D47A1);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(30, 136, 229, 0.4);\n    color: white;\n}\n\n.btn-success {\n    background: linear-gradient(135deg, var(--color-success), #1B5E20);\n    box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);\n    color: white;\n}\n\n.btn-success:hover {\n    background: linear-gradient(135deg, #1B5E20, #0F4C14);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(46, 125, 50, 0.4);\n    color: white;\n}\n\n.btn-warning {\n    background: linear-gradient(135deg, var(--color-warning), #F9A825);\n    box-shadow: 0 4px 12px rgba(251, 192, 45, 0.3);\n    color: var(--color-text);\n}\n\n.btn-warning:hover {\n    background: linear-gradient(135deg, #F9A825, #F57F17);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(251, 192, 45, 0.4);\n    color: var(--color-text);\n}\n\n.btn-danger {\n    background: linear-gradient(135deg, var(--color-danger), #C62828);\n    box-shadow: 0 4px 12px rgba(229, 57, 53, 0.3);\n    color: white;\n}\n\n.btn-danger:hover {\n    background: linear-gradient(135deg, #C62828, #B71C1C);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(229, 57, 53, 0.4);\n    color: white;\n}\n\n/* CTA Buttons */\n.btn-cta {\n    background: linear-gradient(135deg, var(--color-cta), var(--color-cta-hover));\n    box-shadow: 0 4px 12px rgba(251, 140, 0, 0.3);\n    color: white;\n    font-weight: 600;\n}\n\n.btn-cta:hover {\n    background: linear-gradient(135deg, var(--color-cta-hover), #EF6C00);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(251, 140, 0, 0.4);\n    color: white;\n}\n\n/* Soft Buttons */\n.btn-soft-primary {\n    background: rgba(30, 136, 229, 0.1);\n    border: 1px solid rgba(30, 136, 229, 0.2);\n    color: var(--color-primary);\n    font-weight: 500;\n    transition: all 0.3s ease;\n}\n\n.btn-soft-primary:hover {\n    background: rgba(30, 136, 229, 0.2);\n    border-color: rgba(30, 136, 229, 0.3);\n    color: var(--color-primary);\n    transform: translateY(-1px);\n}\n\n/* Bootstrap Color Classes Override */\n.bg-primary {\n    background: var(--color-primary) !important;\n}\n\n.bg-success {\n    background: var(--color-success) !important;\n}\n\n.bg-warning {\n    background: var(--color-warning) !important;\n}\n\n.bg-danger {\n    background: var(--color-danger) !important;\n}\n\n.bg-info {\n    background: var(--color-insight) !important;\n}\n\n.bg-light {\n    background: var(--color-surface) !important;\n}\n\n.text-primary {\n    color: var(--color-primary) !important;\n}\n\n.text-success {\n    color: var(--color-success) !important;\n}\n\n.text-warning {\n    color: var(--color-warning) !important;\n}\n\n.text-danger {\n    color: var(--color-danger) !important;\n}\n\n.text-info {\n    color: var(--color-insight) !important;\n}\n\n.text-muted {\n    color: var(--color-text-secondary) !important;\n}\n\n/* Alert Components */\n.alert-success {\n    background-color: var(--color-success-light);\n    border-color: var(--color-success);\n    color: var(--color-success);\n}\n\n.alert-warning {\n    background-color: var(--color-warning-light);\n    border-color: var(--color-warning);\n    color: var(--color-text);\n}\n\n.alert-danger {\n    background-color: var(--color-danger-light);\n    border-color: var(--color-danger);\n    color: var(--color-danger);\n}\n\n.alert-info {\n    background-color: var(--color-insight-light);\n    border-color: var(--color-insight);\n    color: var(--color-insight);\n}\n\n/* Custom Badge Colors */\n.badge.bg-purple, .bg-purple {\n    background-color: var(--color-insight) !important;\n    color: white !important;\n}\n\n.text-purple {\n    color: var(--color-insight) !important;\n}\n\n/* Enhanced Section Backgrounds */\n.hero-section {\n    background: linear-gradient(135deg, rgba(30, 136, 229, 0.1) 0%, rgba(126, 87, 194, 0.08) 50%, rgba(251, 140, 0, 0.05) 100%);\n    border-radius: var(--border-radius);\n    padding: 3rem 2rem;\n    margin-bottom: 2rem;\n    box-shadow: 0 8px 32px rgba(30, 136, 229, 0.1);\n}\n\n.analysis-options-section {\n    background: linear-gradient(135deg, rgba(46, 125, 50, 0.08) 0%, rgba(30, 136, 229, 0.05) 100%);\n    border-radius: var(--border-radius);\n    padding: 2rem;\n    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);\n}\n\n.recent-analyses-section {\n    background: linear-gradient(135deg, rgba(126, 87, 194, 0.08) 0%, rgba(251, 192, 45, 0.05) 100%);\n    border-radius: var(--border-radius);\n    padding: 2rem;\n    box-shadow: 0 4px 24px rgba(126, 87, 194, 0.1);\n}\n\n.benefits-section {\n    background: linear-gradient(135deg, rgba(251, 140, 0, 0.08) 0%, rgba(30, 136, 229, 0.05) 100%);\n    border-radius: var(--border-radius);\n    padding: 3rem 2rem;\n    margin-top: 2rem;\n    box-shadow: 0 8px 32px rgba(251, 140, 0, 0.1);\n}\n\n/* Form Enhancements */\n.form-label {\n    color: var(--color-text) !important;\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n}\n\n.form-control {\n    border: 2px solid rgba(30, 136, 229, 0.1);\n    border-radius: 8px;\n    transition: all 0.3s ease;\n    background: rgba(255, 255, 255, 0.9);\n    color: var(--color-text);\n}\n\n.form-control:focus {\n    border-color: var(--color-primary);\n    box-shadow: 0 0 0 0.2rem rgba(30, 136, 229, 0.25);\n    background: rgba(255, 255, 255, 1);\n}\n\n.form-select {\n    border: 2px solid rgba(30, 136, 229, 0.1);\n    border-radius: 8px;\n    transition: all 0.3s ease;\n    background: rgba(255, 255, 255, 0.9);\n    color: var(--color-text);\n}\n\n.form-select:focus {\n    border-color: var(--color-primary);\n    box-shadow: 0 0 0 0.2rem rgba(30, 136, 229, 0.25);\n    background: rgba(255, 255, 255, 1);\n}\n\n/* Enhanced Analysis Type Cards */\n.analysis-type-card {\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(245, 247, 250, 0.9) 100%);\n    border: 2px solid transparent;\n    transition: all 0.3s ease;\n    position: relative;\n    overflow: hidden;\n}\n\n.analysis-type-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 4px;\n    background: linear-gradient(90deg, var(--color-primary), var(--color-success), var(--color-warning), var(--color-insight));\n    opacity: 0;\n    transition: opacity 0.3s ease;\n}\n\n.analysis-type-card:hover::before {\n    opacity: 1;\n}\n\n.analysis-type-card:hover {\n    background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(245, 247, 250, 0.95) 100%);\n    border-color: var(--color-primary);\n    box-shadow: 0 16px 48px rgba(30, 136, 229, 0.2);\n}","size_bytes":25861},"static/js/app.js":{"content":"/**\n * RIC - Reflective Instruction Coach\n * Main JavaScript functionality\n */\n\nclass RICApp {\n    constructor() {\n        this.init();\n    }\n\n    init() {\n        this.setupEventListeners();\n        this.setupDragAndDrop();\n        this.setupAutoRefresh();\n    }\n\n    setupEventListeners() {\n        // File input change handler\n        const fileInput = document.getElementById('audioFile');\n        if (fileInput) {\n            fileInput.addEventListener('change', this.handleFileSelect.bind(this));\n        }\n\n        // Form submission handler\n        const uploadForm = document.getElementById('uploadForm');\n        if (uploadForm) {\n            uploadForm.addEventListener('submit', this.handleFormSubmit.bind(this));\n        }\n    }\n\n    setupDragAndDrop() {\n        const uploadArea = document.querySelector('.upload-area');\n        if (!uploadArea) return;\n\n        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n            uploadArea.addEventListener(eventName, this.preventDefaults, false);\n        });\n\n        ['dragenter', 'dragover'].forEach(eventName => {\n            uploadArea.addEventListener(eventName, () => {\n                uploadArea.classList.add('dragover');\n            }, false);\n        });\n\n        ['dragleave', 'drop'].forEach(eventName => {\n            uploadArea.addEventListener(eventName, () => {\n                uploadArea.classList.remove('dragover');\n            }, false);\n        });\n\n        uploadArea.addEventListener('drop', this.handleDrop.bind(this), false);\n    }\n\n    setupAutoRefresh() {\n        // Auto-refresh for processing status\n        const analysisStatus = document.querySelector('.badge');\n        if (analysisStatus && analysisStatus.textContent.includes('Procesando')) {\n            this.startStatusPolling();\n        }\n    }\n\n    preventDefaults(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    handleDrop(e) {\n        const dt = e.dataTransfer;\n        const files = dt.files;\n\n        if (files.length > 0) {\n            const file = files[0];\n            if (this.isValidAudioFile(file)) {\n                const fileInput = document.getElementById('audioFile');\n                fileInput.files = files;\n                this.displayFileInfo(file);\n            } else {\n                this.showError('Formato de archivo no válido. Por favor sube un archivo de audio.');\n            }\n        }\n    }\n\n    handleFileSelect(event) {\n        const file = event.target.files[0];\n        if (file) {\n            this.displayFileInfo(file);\n        }\n    }\n\n    handleFormSubmit(event) {\n        const fileInput = document.getElementById('audioFile');\n        const uploadBtn = document.getElementById('uploadBtn');\n\n        if (!fileInput.files || fileInput.files.length === 0) {\n            event.preventDefault();\n            this.showError('Por favor selecciona un archivo de audio.');\n            return;\n        }\n\n        const file = fileInput.files[0];\n        if (!this.isValidAudioFile(file)) {\n            event.preventDefault();\n            this.showError('Formato de archivo no válido.');\n            return;\n        }\n\n        if (file.size > 100 * 1024 * 1024) { // 100MB\n            event.preventDefault();\n            this.showError('El archivo es demasiado grande. Máximo 100MB.');\n            return;\n        }\n\n        // Show loading state\n        this.setLoadingState(uploadBtn, true);\n    }\n\n    displayFileInfo(file) {\n        const fileInfo = document.getElementById('fileInfo');\n        const fileName = document.getElementById('fileName');\n\n        if (fileInfo && fileName) {\n            fileName.textContent = `${file.name} (${this.formatFileSize(file.size)})`;\n            fileInfo.classList.remove('d-none');\n            \n            // Update feather icons\n            if (typeof feather !== 'undefined') {\n                feather.replace();\n            }\n        }\n    }\n\n    isValidAudioFile(file) {\n        const validTypes = ['audio/mp3', 'audio/mpeg', 'audio/wav', 'audio/x-wav', 'audio/m4a', 'audio/ogg', 'audio/flac'];\n        const validExtensions = ['mp3', 'wav', 'm4a', 'ogg', 'flac'];\n        \n        const fileExtension = file.name.split('.').pop().toLowerCase();\n        \n        return validTypes.includes(file.type) || validExtensions.includes(fileExtension);\n    }\n\n    formatFileSize(bytes) {\n        if (bytes === 0) return '0 Bytes';\n        \n        const k = 1024;\n        const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\n        \n        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    }\n\n    setLoadingState(button, loading) {\n        if (!button) return;\n\n        if (loading) {\n            button.innerHTML = '<span class=\"spinner-border spinner-border-sm me-2\"></span>Subiendo...';\n            button.disabled = true;\n        } else {\n            button.innerHTML = '<i data-feather=\"upload\" class=\"me-2\"></i>Subir y Analizar';\n            button.disabled = false;\n            \n            if (typeof feather !== 'undefined') {\n                feather.replace();\n            }\n        }\n    }\n\n    showError(message) {\n        // Create alert if it doesn't exist\n        let alertContainer = document.querySelector('.alert-container');\n        if (!alertContainer) {\n            alertContainer = document.createElement('div');\n            alertContainer.className = 'alert-container';\n            document.querySelector('.container').prepend(alertContainer);\n        }\n\n        const alert = document.createElement('div');\n        alert.className = 'alert alert-danger alert-dismissible fade show';\n        alert.innerHTML = `\n            <i data-feather=\"alert-circle\" class=\"me-2\"></i>\n            ${message}\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\n        `;\n\n        alertContainer.appendChild(alert);\n\n        if (typeof feather !== 'undefined') {\n            feather.replace();\n        }\n\n        // Auto-dismiss after 5 seconds\n        setTimeout(() => {\n            if (alert.parentNode) {\n                alert.remove();\n            }\n        }, 5000);\n    }\n\n    showSuccess(message) {\n        // Similar to showError but with success styling\n        let alertContainer = document.querySelector('.alert-container');\n        if (!alertContainer) {\n            alertContainer = document.createElement('div');\n            alertContainer.className = 'alert-container';\n            document.querySelector('.container').prepend(alertContainer);\n        }\n\n        const alert = document.createElement('div');\n        alert.className = 'alert alert-success alert-dismissible fade show';\n        alert.innerHTML = `\n            <i data-feather=\"check-circle\" class=\"me-2\"></i>\n            ${message}\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\n        `;\n\n        alertContainer.appendChild(alert);\n\n        if (typeof feather !== 'undefined') {\n            feather.replace();\n        }\n\n        setTimeout(() => {\n            if (alert.parentNode) {\n                alert.remove();\n            }\n        }, 5000);\n    }\n\n    startStatusPolling() {\n        const currentUrl = window.location.pathname;\n        const analysisId = currentUrl.split('/').pop();\n        \n        if (!analysisId || isNaN(analysisId)) return;\n\n        const pollInterval = setInterval(async () => {\n            try {\n                const response = await fetch(`/api/analysis/${analysisId}/status`);\n                const data = await response.json();\n\n                if (data.status === 'completed' || data.status === 'error') {\n                    clearInterval(pollInterval);\n                    window.location.reload();\n                }\n            } catch (error) {\n                console.error('Status polling error:', error);\n                clearInterval(pollInterval);\n            }\n        }, 5000); // Poll every 5 seconds\n\n        // Stop polling after 10 minutes to prevent infinite requests\n        setTimeout(() => {\n            clearInterval(pollInterval);\n        }, 600000);\n    }\n}\n\n// Utility functions\nconst RICUtils = {\n    formatDuration(seconds) {\n        const minutes = Math.floor(seconds / 60);\n        const remainingSeconds = Math.floor(seconds % 60);\n        return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n    },\n\n    getSpeedColor(wpm) {\n        if (wpm < 120) return '#f59e0b'; // warning\n        if (wpm > 160) return '#ef4444'; // danger\n        return '#10b981'; // success\n    },\n\n    getScoreColor(score) {\n        if (score >= 80) return '#10b981'; // success\n        if (score >= 60) return '#f59e0b'; // warning\n        return '#ef4444'; // danger\n    },\n\n    debounce(func, wait) {\n        let timeout;\n        return function executedFunction(...args) {\n            const later = () => {\n                clearTimeout(timeout);\n                func(...args);\n            };\n            clearTimeout(timeout);\n            timeout = setTimeout(later, wait);\n        };\n    }\n};\n\n// Initialize the app when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', function() {\n    new RICApp();\n});\n\n// Export for potential use in other scripts\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = { RICApp, RICUtils };\n}\n","size_bytes":9336}},"version":1}